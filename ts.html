<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Time Series Note - 2&nbsp; 時間序列模型</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./ts_intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.29.1.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ts.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">時間序列模型</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Note</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">序言</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">什麼是時間序列</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">時間序列模型</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#auto-regressive-ar-模型" id="toc-auto-regressive-ar-模型" class="nav-link active" data-scroll-target="#auto-regressive-ar-模型"><span class="header-section-number">2.1</span> Auto Regressive (AR) 模型</a>
  <ul class="collapse">
  <li><a href="#arp-模型" id="toc-arp-模型" class="nav-link" data-scroll-target="#arp-模型"><span class="header-section-number">2.1.1</span> AR(p) 模型</a></li>
  <li><a href="#什麼時候該使用-ar-模型" id="toc-什麼時候該使用-ar-模型" class="nav-link" data-scroll-target="#什麼時候該使用-ar-模型"><span class="header-section-number">2.1.2</span> 什麼時候該使用 AR 模型</a></li>
  <li><a href="#ar1-平均數" id="toc-ar1-平均數" class="nav-link" data-scroll-target="#ar1-平均數"><span class="header-section-number">2.1.3</span> AR(1) 平均數</a></li>
  <li><a href="#ar1-變異數" id="toc-ar1-變異數" class="nav-link" data-scroll-target="#ar1-變異數"><span class="header-section-number">2.1.4</span> AR(1) 變異數</a></li>
  <li><a href="#ar1-自相關係數" id="toc-ar1-自相關係數" class="nav-link" data-scroll-target="#ar1-自相關係數"><span class="header-section-number">2.1.5</span> AR(1) 自相關係數</a></li>
  <li><a href="#ar-order-估計" id="toc-ar-order-估計" class="nav-link" data-scroll-target="#ar-order-估計"><span class="header-section-number">2.1.6</span> AR Order 估計</a></li>
  <li><a href="#ar-模型參數估計" id="toc-ar-模型參數估計" class="nav-link" data-scroll-target="#ar-模型參數估計"><span class="header-section-number">2.1.7</span> AR 模型參數估計</a></li>
  <li><a href="#ar-模型的預測" id="toc-ar-模型的預測" class="nav-link" data-scroll-target="#ar-模型的預測"><span class="header-section-number">2.1.8</span> AR 模型的預測</a></li>
  <li><a href="#ar-練習" id="toc-ar-練習" class="nav-link" data-scroll-target="#ar-練習"><span class="header-section-number">2.1.9</span> AR 練習</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">時間序列模型</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>一個廣義的時間序列模型都可以簡化為</p>
<p><span class="math display">\[
r_t=\mu + \sum_{i=0}^\infty \psi_i a_{t-i}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\mu:\)</span> <span class="math inline">\(r_t\)</span> 的平均</li>
<li><span class="math inline">\(a(t):\)</span> 平均為 0 的白噪聲，通常代表在 <span class="math inline">\(t\)</span> 時刻的新資訊，也被稱為時間 <span class="math inline">\(t\)</span> 的 innovation、shock</li>
<li><span class="math inline">\(\psi:\)</span> 白噪聲的加權係數，<span class="math inline">\(\psi_0=1\)</span></li>
</ul>
<p>從上面的公式也可以看出，時間序列的值等同於一個平均趨勢加上過去每個時間點的資訊，這個過去可以從現在到無窮遠，如果我們再仔細檢查他的平均和變異數</p>
<p><span class="math display">\[
\mathbb{E}(r_t)=\mu, \mathrm{Var}(r_t)=\sigma_a^2\sum_{i=0}^\infty \psi_i^2
\]</span></p>
<p>我們這裡暫時寫 <span class="math inline">\(\mathrm{Var}(a_t)=\sigma^2_a\)</span>，因為變異數存在，所以 <span class="math inline">\(\{\psi^2\}\)</span> 必定是一個收斂序列，也就是當 <span class="math inline">\(i\to\infty\)</span> 我們有 <span class="math inline">\(\psi_i^2\to 0\)</span>，這個假設保證了</p>
<ul>
<li>距離時間 <span class="math inline">\(t\)</span> 越遠的那些資訊 <span class="math inline">\(a_{t-i}\)</span> 影響會越來越小</li>
</ul>
<p>怎麼檢查這件事情呢? 其實我們只要確認自相關係數就好了，也就是滯後 <span class="math inline">\(\ell\)</span> 期的相關係數是多少</p>
<p><span class="math display">\[
\rho_{\ell}=\frac{\mathrm{Cov}(r_t, r_{t-\ell})}{\mathrm{Var}(r_t)}=\frac{\gamma_{\ell}}{\gamma_{0}}=\frac{\sum_{i=0}^{\infty}\psi_{i}\,\psi_{i+\ell}}{1+\sum_{i=1}^{\infty}\psi_{i}^{2}},\quad\ell\ge0
\]</span></p>
<p>我們省略了上面的證明，其實也就是簡單的把 <span class="math inline">\(r_t\)</span> 用 <span class="math inline">\(\mu + \sum_{i=0}^\infty \psi_i a_{t-i}\)</span> 代入計算共變異數而已。對於一個弱穩態序列，當 <span class="math inline">\(i\to\infty\)</span> 我們有 <span class="math inline">\(\psi_i\to 0\)</span>，因此，當時間差越大，自相關係數會收斂到 0</p>
<section id="auto-regressive-ar-模型" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="auto-regressive-ar-模型"><span class="header-section-number">2.1</span> Auto Regressive (AR) 模型</h2>
<p>接下來，我們介紹時間序列中最簡單的模型，AR 模型。AR 模型假設當前資訊只與前一時間資訊有關，公式如下</p>
<p><span class="math display">\[
r_t=\phi_0+\phi_1r_{t-1}+a_t
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\phi_0:\)</span> 截距項</li>
<li><span class="math inline">\(\phi_1:\)</span> 前一時間的資訊保留程度</li>
</ul>
<p>這個模型假設其實自動包含弱穩態的要求，我們可以檢查他的平均數和變異數</p>
<p><span class="math display">\[
{\mathbb E}(r_{t}|r_{t-1})=\phi_{0}+\phi_{1}r_{t-1},\qquad\mathrm{Var}(r_{t}|r_{t-1})=\mathrm{Var}(a_{t})=\sigma_{a}^{2}
\]</span></p>
<p>我們可以看到當我們給定前一時間的資訊後，平均與變異數都與時間無關了，因此自動符合若穩態的定義</p>
<p>Note:</p>
<ul>
<li>Markov 性質: 如果細心一點會發現，當前時間只與前一時間有關是馬可夫鏈的性質，因此，<strong>馬可夫鏈保證給定當前時間，下一期的時間分配完全確定，也就是不需要再往前看更多期時間</strong></li>
</ul>
<section id="arp-模型" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="arp-模型"><span class="header-section-number">2.1.1</span> AR(p) 模型</h3>
<p>前面我們假設想要知道當前的資訊，我們只需要檢查前一期即可，我們把這種模型稱為 AR(1) 模型，同理，我們可以定義 AR(p) 模型</p>
<p><span class="math display">\[
r_t=\phi_0+\phi_1r_{t-1} + \cdots+\phi_pr_{t-p} + a_t
\]</span></p>
<p>也就是當前時間與前面 p 期時間都有關</p>
</section>
<section id="什麼時候該使用-ar-模型" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="什麼時候該使用-ar-模型"><span class="header-section-number">2.1.2</span> 什麼時候該使用 AR 模型</h3>
<p>接下來我們會想知道到底什麼時後該使用 AR 模型，最簡單的方法其實是使用 ACF 圖判斷，那麼 AR(p) 的 ACF 圖長什麼樣子呢? 我們來畫畫看</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> acf(series, lag<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate the autocorrelation function (ACF) for a given time series.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">        series (array-like): The time series data.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        lag (int, optional): The maximum lag for which to calculate the ACF.</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">            If None (default), the ACF is calculated for all possible lags.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">        acf_values (array): Autocorrelation values for the given time series.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">            If `lag` is provided, returns a single value representing</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">            autocorrelation at that lag. Otherwise, returns an array of</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">            autocorrelation values for all lags.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    series <span class="op">=</span> np.asarray(series)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(series)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.mean(series)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    centered_data <span class="op">=</span> series <span class="op">-</span> mean</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate autocovariance function</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    acov <span class="op">=</span> np.correlate(centered_data, centered_data, mode<span class="op">=</span><span class="st">'full'</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    acf_values <span class="op">=</span> acov <span class="op">/</span> <span class="bu">sum</span>(centered_data <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> lag <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> acf_values[(n<span class="op">-</span><span class="dv">1</span>):(n<span class="op">-</span><span class="dv">1</span><span class="op">+</span>lag)]</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> acf_values[(n<span class="op">-</span><span class="dv">1</span>):]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>同上週，我們先定義一個 ACF 計算函數，接下來簡單生成 AR(1) 過程的資料，我們就拿隨機遊走做示範</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'Random Walks'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> []</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    loc <span class="op">=</span> loc <span class="op">+</span> np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    walks.append(loc)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> np.array(walks)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>walks, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="72cbaaee-b056-4a0d-b051-4e19df5ac5a5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("72cbaaee-b056-4a0d-b051-4e19df5ac5a5")) {                    Plotly.newPlot(                        "72cbaaee-b056-4a0d-b051-4e19df5ac5a5",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"lines","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.09327637991355239,0.049388912163170845,-2.152682422928254,-1.830626141188844,-1.39746956038456,-1.9833564432505353,-0.7516980196375183,-0.42046761462448606,-0.543415247215927,-1.585583865132587,-1.904906387185243,-0.9338076314632783,-0.12583070211225622,1.4293813273293579,1.1765957286819406,2.0133005179423202,2.9504599401641936,3.4765511744780215,3.948857017928277,2.56680524877018,1.163279410727921,1.9569499794597645,3.3309462512362895,1.6807480696613875,2.276371188603603,1.3842424052716495,1.4211547112218996,2.454392417992432,1.1223545624001101,1.244912930578428,1.6004722290074567,1.068960981417339,1.0282573395700618,1.2594910371447863,1.7998723007988966,2.2894065744100285,1.9717607336580836,2.1333007891812876,2.4545820677509926,4.083735772515659,3.8121056386141414,3.7367053568966817,5.648319399098669,5.6005590038236805,3.099047745313702,1.6279429712173341,1.9939288141477487,1.4726360146157886,2.4263552218170457,2.36415969890782,1.5476807851110963,0.5617966761883404,0.4948267326701846,-1.04582368960537,-0.6977999584634524,1.1891343377948527,1.2254187497362157,2.155278714245761,2.009683439739046,2.6008437256359898,2.5610231678417272,4.275073377049896,5.07316384717336,3.601371512350082,2.456055577865131,4.204794951710697,3.8709262704911964,3.853561958850872,4.275644577262092,5.918198727266866,5.10326843473318,4.106781165101369,3.1796064868439444,2.819618186630881,1.384360373117738,1.6163746555564886,1.9452862661216723,0.5896446876720256,0.27096043826820587,0.08278180469342286,-0.08306909293134038,-1.4576484729301846,-1.9347671750549642,-1.1372247308414032,-1.4325415298077306,-0.7240017668133586,0.43630843369532346,-0.05414960554837511,0.3878673783835675,1.1179997192860018,4.922896039561652,4.586888781827542,5.391572477550884,4.554494872049334,4.716378830454207,5.0017351665671095,5.054593011628467,5.363171636509499,5.341117435588312,6.73059378778202,4.420337407163583,3.7852979990329207,3.150201826379116,3.823164129286029,4.385985945684445,4.4805031741094306,3.2751708627962484,4.363610331338278,4.205631794098797,4.33785899877461,2.6937517795557553,5.322061248787227,5.361343737897745,4.761484074294032,3.1402214159594823,2.395902813077679,1.4132430375191531,1.1841539587851329,1.7138637963371992,1.0335305404816852,-0.3864498935598002,-0.025124951750647884,-0.008079144359527918,0.334311170238492,1.282956350143088,2.519501704407886,2.3784000270937797,1.6774611816985603,2.545256354992985,2.0618069113013444,2.879982223398255,1.7829312382819142,0.3581426098186946,-0.9305606807815643,-0.9118764684259371,-1.101465085407491,-0.7533379331452069,-3.2861619117313405,-3.6081654057180352,-3.981133431755985,-4.2731991236086175,-4.337639602413343,-3.9696484916965047,-1.6500339387051084,-0.6606031726385666,-1.920425533436717,-2.504134711894101,-1.5550453954692984,0.1881614304475201,3.8464729952750725,3.3747089780585924,3.585487078808429,2.9728187433934385,2.456238699785562,3.2987515451346887,3.235622101239375,4.712900266763534,4.89781077076315,4.524830283246608,6.075343029298705,5.779711060866404,6.1954130003726515,5.548551377062498,6.953123448375808,5.326398861753321,6.359812602719199,7.152546746041854,6.650847882203906,6.848873696683003,7.570517783364907,6.927697435416597,8.152963795473486,9.57697118284541,9.021236308873132,6.791406278953886,6.244179129271847,7.444256805943518,5.618856727917353,3.233245833113937,3.306604998219567,4.773951625497581,3.7902244954592117,4.307150020411705,5.454497205838829,7.367770564542754,7.049159798482008,7.027893100236673,6.627438298363337,4.860043638525186,5.265082852558342,6.53707841327536,6.224253701179902,5.3950131986829355,7.063375508519671,6.468952647774763,5.847153405227396,5.975960637057166,6.854842220940787,7.226678687414258,6.4627455296217695,6.767415523165067,7.503433288849701,6.018410711740878,6.465246980500662,3.5295414764131783,2.424884249543661,1.9148698617925333,1.6248850941717432,1.311738376556084,0.7294702190022881,-0.4670356725478586,-1.1969147785416099,-1.5531548005186107,-1.2430089799032236,-0.15024152676184355,2.4483119876457433,2.3823094337348234,2.3486511828803316,1.259519035184374,1.7840584372318606,1.8702262785483936,1.4539756868763296,1.2899933107245811,2.9010622419100685,2.934722202671221,2.2127825716597496,1.148643342283237,-0.3513881835440684,-1.9103377529748564,-2.5397842283664565,-2.3693598072185047,-2.2497602956909932,-2.5581784444403697,-1.3739195159961595,-1.1341507518898584,-2.4252579008472663,-1.481240035578277,-1.03764371274875,-0.8735688048234224,-0.2678639266019217,-0.8342593582368537,-1.0309501001218788,-1.4405719024875867,-0.5341521998682015,0.5886212454986244,0.1454810982973465,1.4783817240262915,0.9612525519982763,1.0273866305976638,0.18638604230062705,-0.4939013764365753,-0.7269486393422366,0.7636874071230217,1.2027721237774516,1.2541526637996954,2.6215248376539293,2.2589126148297436,1.2926048947945459,1.5910528325751447,1.0814268404240204,1.4803242442456974,0.044958677714608264,0.8466748317706347,1.0735189998670778,0.7152838412900976,0.9623758818629686,-0.30378140968743006,0.43432300658658773,-1.2813854946837606,-2.129603160743283,-1.9160409540910706,-0.5296745584534128,-0.5030153581403946,-0.0733080201144019,-1.2999840918340126,-1.8050558982509024,-2.68755818708492,-3.351256010636855,-3.852552845841646,-4.6305955171655215,-5.565836045766725,-6.467365046944302,-4.183300140911319,-4.441026623469885,-3.32228825795381,-5.59106743685499,-5.94995812137999,-6.182876528533531,-8.425601541468604,-7.387695692713777,-8.06327860590533,-6.367656445538376,-4.675724506696008,-4.4146102253973964,-2.8564939616242757,-1.5888620494982357,-2.5513607042550728,-3.0621021928828487,-5.688992395958317,-6.615762197315846,-6.082779267835344,-6.930112592412696,-6.26064183916163,-7.004009630744245,-7.9430886857537315,-8.475617140403912,-9.51677552124081,-10.485522632843978,-8.659747061907742,-8.5570607579135,-6.453828763971514,-6.860678102724669,-7.0522655344171215,-8.322734087941534,-10.038564797046451,-10.04748651382435,-9.408887217589246,-9.351418053000017,-9.323684874065927,-9.515709343718754,-8.65319367218016,-10.217900931571524,-11.18851312145259,-11.859755164886687,-11.87469220579903,-9.18017200155038,-9.058242686955591,-8.563077083917992,-7.2901027620909336,-7.1378832124790526,-8.557541614078893,-8.056059375102096,-7.667447947484718,-7.796158878963797,-6.230954924854329,-6.429963056571006,-6.698697860021769,-5.649275054864459,-5.5723421925843715,-8.456755762093982,-7.446098028227942,-6.567102901260197,-6.935097792973403,-8.278763790815828,-9.194112528785688,-10.32952751783514,-11.59234296714339,-12.35329083287216,-12.049612907594753,-11.938498098905242,-12.52764417259041,-11.361044473206885,-11.552956387348154,-11.808383889606882,-12.460418760147153,-11.885210363906577,-12.341089402696404,-11.425072681417763,-10.868967684499788,-10.255275640837441,-11.858202979289167,-11.502550696215879,-12.689061842505534,-12.856899789610434,-12.724417693585867,-14.33688208917746,-14.895033534924728,-14.321638450725684,-13.768746970923791,-15.87454127497577,-16.37453212816243,-16.905032106424557,-17.487730195858184,-18.042602710765163,-17.837131969599906,-17.503767784032938,-15.950612555834063,-15.619281142031255,-16.37303402037211,-16.299073848843697,-16.981790485973747,-17.349939811420576,-18.099233868736835,-18.428108049194808,-17.76233006276732,-17.501287279814296,-18.056071915137185,-17.938602791135704,-16.96745066342277,-15.152385183552814,-14.131018463206598,-13.835106432055618,-13.414311650585315,-12.817994885599123,-14.506224526425134,-14.29588422440841,-13.91193148561503,-16.936674269711286,-17.631878057919163,-18.095489806249486,-18.509788379718355,-18.298669261631893,-17.903879694877805,-16.772249093673384,-16.72523171390308,-18.358138453120254,-17.00071446622311,-17.596202725014795,-19.032294375551437,-16.411708828192495,-16.376565654925336,-17.321722582054722,-16.504271155499232,-16.433876292245746,-18.273316654377844,-18.46599860003603,-18.1040852251986,-19.323969693196613,-20.093002475157785,-19.930091016154858,-19.5426596424892,-20.789752492676982,-18.96979071286437,-18.34449343817067,-18.439646907212758,-17.837296636017165,-18.424102857681905,-17.943932409836183,-18.68572128107598,-21.057766664619525,-21.105234863253415,-21.06726130693206,-21.273737571434715,-20.443976497656955,-20.80565469630442,-20.33590086025496,-19.363419725064244,-19.822965806654466,-20.1112696353021,-21.034542943960307,-19.56408910003427,-19.21567162833588,-19.83158213885249,-20.58376729765111,-19.893772997410164,-18.02606655941163,-18.08496426504951,-19.34824097046079,-19.69428242316838,-19.378100221740716,-21.447888103659473,-21.37983553184341,-20.267282898018568,-19.7569626152075,-22.825799164588354,-21.461336723931634,-21.705404088209168,-22.212488923540977,-21.59803057730521,-22.644262799318227,-23.78903706334566,-23.744017598022545,-24.049111195601547,-24.52306794331132,-22.953023760144482,-22.60986266781519,-22.30943295224146,-22.056408473147155,-23.876999070309843,-23.21437515678753,-24.52735654289347,-23.41398735878977,-23.181782258240027,-22.027378807686695,-19.568565993333504,-15.782200725477272,-15.64987260739197,-16.029476203162673,-16.10219857502113,-16.11132474141917,-15.408866492945581,-16.295218836455756,-15.943800455607912,-15.229841614960984,-16.203430987384912,-16.1022037649624,-16.656892784976023,-14.930202833270984,-14.616160458051288,-14.888711031126416,-14.927134490424264,-15.01406353273028,-15.39507598013915,-17.444797404088856,-17.23960676505429,-18.266001531663395,-18.928660892921368,-17.89479946197756,-16.642742760769245,-16.530334893807197,-16.383666388817318,-16.141470014316365,-16.62886742000403,-17.42268298037588,-18.279515719998912,-17.706826355745555,-18.90800565607346,-18.806147297876816,-19.64050392088143,-18.72935309644907,-19.66125313454348,-19.641565991459284,-20.9857159217931,-19.572480503145194,-17.931518150048756,-18.72440123711082,-19.90863175643477,-18.89898006472746,-18.528532545892396,-20.060310263951646,-19.170065867741286,-19.637052554112902,-19.36933987584022,-18.897512646392194,-18.706801628834576,-19.512151920773903,-18.028725935786092,-18.335632792339176,-18.594291177942765,-17.572844053423516,-17.600328736074836,-18.196634705449046,-18.765903763993425,-19.091822386432447,-18.958989794648232,-20.80072438458968,-20.616404709836214,-21.658901499212778,-21.010275029097954,-22.250872769396953,-23.049941352337406,-24.058657141262064,-24.428900844357045,-24.371285786922517,-24.021158348849692,-24.488104055641713,-23.502972623663403,-23.943404530216252,-23.99873138817166,-23.59125861647563,-22.96785052899179,-21.71802649564579,-23.46053654346686,-24.88076058894726,-24.55800610461226,-23.773316955984477,-24.09630611017095,-23.337688413699475,-24.204074381943627,-25.633731404642546,-25.8068026892499,-24.68594526729926,-26.54211702323234,-24.635839330752766,-24.281370951539557,-26.161129106016606,-24.92673221595099,-25.200324801800694,-24.51038897117519,-23.93808946169897,-24.06911412030021,-24.456432767424115,-23.942479667837123,-23.936197984272546,-24.69441451400406,-25.668639267604522,-27.505204334695286,-26.835924953633008,-24.969686129808927,-25.14873662637994,-25.698178157457434,-24.944963789990457,-25.24085185149647,-25.825942643732752,-26.233713576532644,-25.675798253384144,-25.76923426363874,-26.805573173831146,-26.949867135431283,-27.985291100435553,-28.459492641763386,-29.71010947342577,-29.113361320754034,-30.421427411825228,-30.807036146434914,-32.71462040495759,-32.62513604302887,-32.86710726060315,-33.68111674123553,-34.491583146573824,-32.25525425173758,-30.93637889148242,-31.55783786142536,-32.57795018458,-31.9481576134476,-32.16134558624826,-31.59248218594647,-31.208774401320373,-31.958224978301963,-32.642041288087526,-33.36906092391245,-32.60466443679965,-32.373129426443725,-32.24254157185129,-32.24976688269366,-32.37617322624777,-31.87811611527507,-32.31092084971874,-32.53312638076682,-33.86868962539662,-34.145756100117865,-35.73687907110723,-35.12128581302454,-35.696200751752656,-35.98943866263117,-36.09831936330031,-35.03366543531267,-35.81326506452746,-36.50494397354892,-37.42352791154717,-38.21255682440146,-38.39201981023444,-38.35399207886945,-37.980079043485574,-39.709371332061735,-40.031121705237084,-38.06890780893092,-39.647095328462356,-40.44012472581632,-40.760016342269616,-40.669832665557394,-40.444502545572355,-41.79857619978957,-42.61465560524502,-41.3362895231817,-40.453387749996395,-40.13898580703879,-41.04788507742962,-39.62744830475997,-39.588556374395324,-40.625897543815206,-42.8193015133161,-42.78917509503545,-42.730573505728735,-42.6327640266835,-41.871021630951624,-41.5887847169306,-42.599517391613816,-42.674729375134184,-42.643030004666585,-43.56017442214632,-43.58117827750042,-43.3878505218566,-44.00743038853735,-43.412386241089315,-41.81009152505481,-41.927024675549546,-40.400383291565504,-40.52716055311151,-40.43120435526075,-40.27176594897565,-41.527123032412256,-42.54600216266816,-42.07759417915222,-42.36353357022595,-43.2850088669861,-40.73956012547258,-39.82916622004056,-40.28313826933713,-40.0180480107319,-40.67789486917667,-38.83302954828022,-40.20917752423301,-41.74277612871003,-40.94681155131561,-42.54803462786607,-44.11302596374238,-43.34484281783455,-44.411386949293174,-44.47135312451968,-44.21925975301444,-43.01190161983344,-43.96904886961669,-44.0304832692958,-43.418560463933275,-43.45450722759464,-42.388577106742176,-42.23794221036234,-42.398508656003045,-43.235543549468545,-44.37662978154324,-43.37243100501633,-42.820536564111066,-43.65187698508447,-43.059140982078716,-43.568551094654836,-44.016918879188545,-45.93691528089421,-45.4090210578733,-47.297230611546844,-46.125467132164026,-46.39351110371907,-47.18176937497704,-47.92741878878354,-47.773553339998,-49.67226568624892,-50.286277988189106,-49.99339439405128,-49.8100788885428,-48.27893610669256,-47.99001948125084,-49.05120770216384,-49.81638372307865,-52.60428021072955,-54.0581631500259,-52.94221422603831,-51.7950849592147,-51.17114215311544,-51.04804417826827,-50.11788598809683,-50.064350370542336,-50.01295484886376,-48.74989540347937,-48.101901328385914,-48.196096849379586,-47.11892743475058,-45.750369087868386,-45.358257880696506,-45.42793313044201,-44.914609104960995,-45.09936287096627,-44.96733866116837,-44.979156258063114,-45.176143697871794,-43.57337735727164,-43.46389800399754,-43.37714004324415,-43.02272211670676,-44.4900923931565,-44.906983969533464,-45.24224866511325,-45.25724897324537,-46.48116964468266,-46.032066378636046,-45.65165173511701,-43.80313587109764,-42.81142485410763,-42.94458685204078,-43.86095279868059,-45.18178357096432,-47.569575414152936,-45.10970791500174,-45.17581916958723,-45.65136592170707,-46.510896506682,-45.22475955612466,-44.69947643826221,-43.45001210179705,-44.768895008095036,-45.5584326120519,-43.89385509124743,-42.81953894019299,-43.28110254188404,-43.880835784007076,-44.84309814189029,-43.99142545246463,-42.19410303379744,-41.968148835670526,-42.714706543051165,-43.099804544555894,-44.27629127674725,-45.046834362909436,-44.45649713984444,-43.91837543456439,-43.1236873302614,-43.7884010208845,-43.816200496883624,-45.55782908113081,-46.744911732728205,-46.73143553304682,-48.810911374790855,-50.29339718295262,-52.06316324605051,-50.529841682182,-50.509357925457344,-50.80181224329253,-51.72876190834793,-51.76306912243883,-50.6152512151845,-53.736915472258175,-53.78545654100215,-54.047431524118224,-55.32889670156221,-54.97474462180494,-54.03181199633538,-54.565486072858576,-53.43584302517311,-52.97999308024671,-50.89841815218601,-51.62132020651594,-51.019888480096576,-50.843412066382676,-51.24975330875186,-51.37964130836696,-49.97524112382419,-49.95710580732771,-49.74197435365545,-49.3057611192228,-49.74597483904954,-48.5470340880449,-47.09821841647809,-47.404398449615115,-48.08583707752774,-49.7393900383638,-50.09239752084839,-47.741449906612445,-46.70616550660022,-47.35616728622751,-47.08693233147113,-44.88417890029982,-45.63101442748157,-45.32848002660149,-46.077002621683214,-45.28364124656727,-44.40116940323165,-45.11619887751271,-44.38579989955275,-44.9554185404205,-44.6661417366976,-44.32041544063868,-46.37233514409733,-46.98575570065235,-47.036567943939225,-46.458053287709276,-46.33911412541116,-47.19041505591021,-47.09768236644021,-47.40103050266146,-49.14012257560615,-48.978974459880675,-49.05108406383347,-48.74514647793776,-48.182790186822885,-47.996870180832985,-48.2670639736194,-50.14168406782668,-50.89866391528253,-51.45868091523753,-51.154820366049556,-51.09435241305058,-51.111355365776205,-50.33425941006293,-49.79991315391483,-51.02493365980557,-51.211681615064805,-51.87499807140928,-54.55816676453074,-53.0632680901093,-55.08274025266147,-54.841822445451164,-53.52432417881707,-54.17100487928253,-53.40690633444366,-52.0138128561493,-52.441356596597586,-52.49413814473012,-51.03620276834406,-51.187643091074804,-52.11373976260772,-53.32444987272899,-53.141582384861145,-52.14011655700885,-52.22397067535258,-53.95979872876147,-54.00077516868658,-55.298842121938314,-54.911661511657506,-54.86275087339236,-56.50741392347917,-55.70737313742912,-54.30134220020773,-55.33352922371747,-56.60943750067497,-57.61797236350128,-56.517151531493106,-56.16827702394564,-56.294798663886525,-57.62463423406518,-59.02347633734203,-59.26416208529424,-58.10096665070451,-58.12526053878102,-56.76565317790447,-58.689971159474155,-59.03478505838118,-60.145370666429564,-60.32517365634543,-60.73884445277006,-60.06695774674593,-60.29150552166769,-61.403047705119384,-60.965669123494834,-62.25763064828096,-63.24918060050517,-63.732134506822156,-62.63830782905351,-64.08945577257484,-64.10217350607024,-62.623253188077065,-64.01784923759975,-64.1270248531328,-63.943113315039085,-64.35014687399445,-61.87561910411527,-59.85971070419492,-60.041791937058605,-61.19922556814017,-63.091969860979425,-62.35016689274152,-60.4815548477902,-61.941116990523575,-62.635808244360156,-62.98311647875741,-63.06632969498409,-63.72051001319573,-63.34674222457693,-64.24041736181545,-63.48609991091165,-64.78928576014636,-65.01761275911228,-65.97637501411664,-65.30853179840497,-64.84134674300233,-65.22617838775744,-65.20163978826756,-65.41280539384636,-63.946660527688174,-64.57808183453143,-65.10350919544332,-64.59714986559834,-64.14541914628396,-65.69808965068617,-65.66331071593186,-66.93095197934797,-65.30507429768393,-65.54246109862841,-65.62326726109197,-65.50482758342244,-65.62714238262964,-65.75932040968948,-65.78098544782345,-63.98081415197193,-65.69089084690026,-65.38673673748382,-65.86588980341874,-66.29659382060895,-64.55648547016139,-64.19538204058937,-65.31443965679102,-65.01100302605579,-66.16352943068212,-64.46748751504069,-62.96955564437892,-62.6714770512301,-62.02040104812482,-61.002240599258606,-62.59105060710434,-63.41483321471018,-63.68582752872333,-65.09669447884676,-66.32628207760622,-65.8984522257613,-66.17498010227393,-66.83003550603222,-66.78471421594253,-68.00581058447771,-66.96169872327494,-65.75281698901041,-66.62013698187899,-64.84241220981461,-65.64465569397875,-65.23968848238626,-66.44659860005288,-66.27185241047712,-66.19027312784205,-65.93027771030107,-65.4066349359892,-65.9411243423481,-65.07730243586589,-65.70186723186984],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Random Walks"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('72cbaaee-b056-4a0d-b051-4e19df5ac5a5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>接下來我們畫出 ACF</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rw_acf <span class="op">=</span> acf(walks, lag<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF Random Walks'</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>rw_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="2fca8746-b09b-433e-b92e-cec433b76778" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2fca8746-b09b-433e-b92e-cec433b76778")) {                    Plotly.newPlot(                        "2fca8746-b09b-433e-b92e-cec433b76778",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.9999999999999989,0.9968849854304215,0.9938113728938854,0.9908801697334608,0.987948807107022,0.9850049834432524,0.9821711845999095,0.9792684364337673,0.9763637779543067,0.9734956493552243,0.970579303700919,0.9677491744591846,0.9647931946188126,0.961967142363494,0.9589604846903776,0.9558654267668353,0.9528733065889973,0.9499641794644965,0.94695112626844,0.9439433061890491,0.941013387115913,0.9383006252455669,0.9356057857879744,0.9328495705721164,0.9301860664397923,0.9276001778533399,0.925004622511748,0.9223632699961642,0.9197093927763164,0.9170030166603508,0.9141724255510474,0.911461357424201,0.9086829799747375,0.9059476780912284,0.9031505804403008,0.9002436681805087,0.8973070451751028,0.8944185299139347,0.8914958400099008,0.8887102300361063,0.8857105201361873,0.8827042159346554,0.8797447487416743,0.8766711022706399,0.8734481519077497,0.8704325444379111,0.8675732068944493,0.8646474429049281,0.861925940874456,0.8590639274117089,0.8562697732109807,0.853438796907004,0.85057806323544,0.8477028034051145,0.8449642789466383,0.8420813038208119,0.8391507552489847,0.8361578874711889,0.8331587998496227,0.8301035165615149,0.8269848221738872,0.824001900013485,0.8210166960749424,0.8181363968551463,0.815282603245891,0.8124212148214602,0.8093209194406472,0.806307260470673,0.8033363317502752,0.8003731407284809,0.7973168150207692,0.7945113844344149,0.7916205110821437,0.7886013919952832,0.7857000753158285,0.7829349426081771,0.7800988329794968,0.7770496322389303,0.7738897068910365,0.7708373673645723,0.7677770804019908,0.7647353855062596,0.7617782783733069,0.7586670319522966,0.7556062565143142,0.7527329382542284,0.7496856424324032,0.7465748058358984,0.7434886254403187,0.7404613168272619],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF Random Walks"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2fca8746-b09b-433e-b92e-cec433b76778');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>看起來好像很平穩，但是我們調整隨機遊走前面的係數呢? 我們將係數調整為 0.3，也就是</p>
<p><span class="math display">\[
r_t=0.3*r_{t-1}+a_t
\]</span></p>
<p>我們在重複上面的過程，我們有</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'Random Walks (coef=0.3)'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> []</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    loc <span class="op">=</span> <span class="fl">.7</span> <span class="op">*</span> loc <span class="op">+</span> np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    walks.append(loc)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> np.array(walks)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>walks, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="00167f9e-f544-4b51-ae75-98349033f902" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("00167f9e-f544-4b51-ae75-98349033f902")) {                    Plotly.newPlot(                        "00167f9e-f544-4b51-ae75-98349033f902",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"lines","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.8133353103037688,0.23637562238536397,-0.5665508479032396,-0.34360596300702717,0.09096634160719619,1.0487493342132472,0.30947539227124615,1.4791159572340646,0.12703468536503915,0.3312627000830778,0.5194166670153224,1.826216522281071,2.517952975429064,0.8878204081886044,0.8551910823920614,0.30136026680548506,0.9041681715877614,-0.0003131693998028595,1.6573834146509232,-0.1615624966708018,-0.3178054961712958,0.2751135399103334,1.662781867749305,2.5035981520061217,1.1715415385792958,0.08524640974641806,1.2720936021522489,0.6210283041116842,-1.352369134906174,-0.5102388195377964,-1.3462972972694813,-1.2842870992281261,-2.035523516110447,-1.4535107919365116,-1.5265951923832084,0.25999712628021854,0.6246030403319578,0.14997025691789118,0.034347812968529276,2.5981689702758706,2.5354489569557823,0.7184973651484692,0.4743078761151048,0.4569349532263125,0.32958152317214656,1.0286272006845822,0.05292806205712941,-0.8656741487343238,-1.451741261668276,-1.6483823105520155,1.1025709929014404,0.9586119081030611,0.8029209639755845,0.3413850888050549,-0.322797063579732,0.192503043313066,-1.9837290771023899,-0.9704409971384006,-2.1778553522768895,-2.3368919392222436,-1.9768520195944848,-0.9593885510584362,-1.1080465023827737,-0.8048997599641796,-0.3430160149943693,-0.9430451225077241,-1.6407008276398416,0.16104926887356652,-0.29617529454554076,0.6659787932910978,0.7535951502137581,-0.3517792766182013,0.011931307119035506,-1.3817717497236948,-0.14888491327792364,-1.1387607772044108,-1.804644855274193,-0.7876458342214947,0.8974396916320128,-1.1907119421466978,-0.4553895508621144,-0.9416795729846383,0.7791526108586132,-1.3268363353201065,-0.3708256770562284,1.1327995644404716,0.9375594225298282,0.22774653132176814,1.3792195628302584,0.5907570035382423,-0.7134056275751206,-0.10085791735682553,1.0452162080942544,2.2806162331327866,0.5996989238961672,0.7554021652930838,-0.7771047255263624,0.06591491578079345,1.1567270464167108,2.377025331874289,3.8930726651350844,3.519749599800721,2.6443184863884963,0.7113403211436937,1.0384403218756082,0.4670728386316623,0.2786549577041001,0.5431419420459833,-0.9991787167401481,-0.5351696366156655,-0.9054235505271703,-2.175971265608939,-1.3885898032630304,-1.3067170120760798,-0.735687406174593,-1.740553989513475,-0.3205850178150629,-1.5135986598805313,0.4866115738862238,0.7426201498210258,-0.9699795514926396,-1.1673562431872404,-0.2993564628565405,2.2567149145694922,2.7550261748995775,1.3639832881442278,1.5591522905703528,2.340165558587512,1.1340850264425921,0.861515188520717,-0.8869429130806731,-1.070322215945429,-2.171487172543178,-2.9476720020169687,-1.275442959428679,-0.18995817984694308,0.35104899254943034,-0.6990090365860261,-0.3597785696531921,-0.23814041668214986,-1.5670028640780889,0.6133347758032632,-0.8830073459792165,-1.6701015254378084,-0.5854899268443802,-0.6292885010112914,-0.2825829041651636,1.726888446870986,1.9901823913985166,0.9375301230508972,0.0037084276660799276,-1.5676583029530535,-2.665743586860341,-3.0004801403127797,-0.7878551376815588,0.20565419631344517,0.6246902659483955,0.6649850538279315,0.8239606459353135,0.681435679613138,1.6348053822069017,1.9984900433304527,1.1415838106017713,1.2934654951559446,1.0940469324624504,0.7983494365834477,0.5991215267095943,-0.007885715334675358,-0.2173791550318855,1.4572017894346116,0.1409743102150698,-0.6966245077414253,-0.44321837352152677,0.727140737515629,-0.5974732287642384,0.12667465766420327,1.4770190697443795,-0.1470240292653977,-1.4540554667854244,-0.371015887849656,-1.5354932220497481,-1.5332048606076412,-0.9367906177054105,-1.6724375695181233,-0.8293443465406312,0.5199500746878126,0.22284539795399447,1.3938053553028258,2.3100033905662065,2.169701255494997,2.2950828563699646,3.7977831855057196,0.6577847053738437,0.7110467373156615,0.9952582529572581,1.1489826851156142,-0.6718265270342392,-1.1987576616303428,-1.533031999599416,-1.163671948227352,0.3966381801983039,-0.3872643303783604,-1.2020796001275544,-1.456740634196609,-1.8928716838012423,-2.079094165316705,-2.4822847149986513,-0.3080513778383318,-2.6036008198917946,-2.7789282769497,-1.3477704461116122,-0.40914186110322714,0.06852367404297138,-0.7376204288733517,-1.6193061716868664,-1.836281000140421,-1.1707337095742298,-1.061745845111252,-1.473680538982726,-0.37632156884611867,0.32953645393118686,-1.2094833713888435,-1.7946330040444938,-2.026695889388642,-1.9702089406843615,-1.4783620198255067,-2.3620074087277194,-2.5785915866852536,-1.0265423821111552,-0.7446524472468699,-0.32654135083126445,0.2703834520288072,0.7312556630045685,-0.6039741910748063,0.7192773313467464,-0.45024690266015555,-0.43388266167436407,1.6558554670798897,-1.8144415322336147,-1.9233898191645378,-2.1947032056938287,-2.3308445929533184,-1.0063923877668306,-1.13943263977011,-1.3035998240547988,-1.3604006305661367,-0.410220384240375,-0.4217930107108291,-0.5356244640603924,-2.3197643113830724,-1.352132682652498,-2.0978711769112373,0.06542774717475064,0.17779687730506058,0.8109302096451634,-0.5224323799234374,0.5141593502019963,1.7986843205929357,0.7020567906535717,1.6511811464305097,1.6421717074197635,1.397724393672528,1.1131761197551504,1.1025391411493366,0.7235105632987353,2.016904079365096,1.5242249920075754,1.2582033669776003,0.8092637003604272,1.1109518868927788,0.5676293451581207,0.32810050401550034,0.5738219886608202,-1.027169846128361,-2.5374595203852808,-3.0099696528173663,-1.8490693985016435,-1.7056116563126176,-1.8380946010643138,-2.6436488865296583,-2.069712917744672,-1.982481061064863,0.6878659965928562,1.0794691864189339,0.18864730449769695,0.17303752047213203,-0.04759139839004188,0.010494289383789407,0.4987030011594997,-1.2199346288723856,0.9422538835168603,1.0641566240763147,-1.2313577637953224,-0.6595456210164659,-1.422246925377196,-2.765593604729701,-0.89535462825368,1.074195161289225,-0.5387798070832829,0.4485405779676686,-0.6865838336405375,-0.4824971518202382,1.2459730387623542,0.9721473301120265,0.01785526223783196,-0.007639762713826246,0.017904102658584962,0.9744412829586572,1.9829307276459507,2.4116018133646415,2.103276829767521,0.5373527492046085,-1.9382101449415408,-0.8109623073595338,0.5889508175815513,-0.9066578494304338,0.18737389612334043,0.14099580399792597,1.8866688757114194,0.8815138106644662,1.1328910275555941,1.5178768555710356,1.4991901986136633,1.8768093935932117,3.031989815830394,3.44614564273011,3.0927632901785214,0.8432175564474473,-2.1101920905739644,-2.1469713854773014,-1.5023781239232974,-1.331405330193035,-2.9342490200224978,0.10411144366072733,-0.5817432425196066,0.11367658993309582,3.2301667218143875,3.2166487289418875,1.6839803044364081,0.5529452944167254,0.9092785695736327,-0.6129381153642635,-0.0654710986214257,-0.3646445818715223,-1.5683223920890057,-0.7704441873604984,0.0011350292081743207,1.750295437402358,0.7027858317574762,0.22795511673934088,-1.352960173872579,-2.307287937774787,-0.9822854587222236,1.0346416124510556,0.7807823615148565,1.8563384465454624,-0.2525161942064915,0.07645734406202934,-0.1824242251870573,0.46826255035114217,0.4928564414963231,0.27710130762619983,0.6364423653560215,1.5273496544107108,1.992771515380254,0.5079455749373004,0.8735699675842732,1.8046999638143746,2.079176280861256,0.8130851120714636,1.5452905175907063,2.100002233168844,2.0951745988742543,1.392671004469226,-0.05974687886762997,0.8267450787664589,-1.3377419080530064,-0.5992681697729344,0.4183122619100266,0.29005233009864617,1.0108173806192289,0.4047665797521942,-0.8866757570624415,-0.4639037463856587,1.1543437955600035,-0.639470224856006,-1.161293658728487,-0.20320963130675118,1.4653346559493927,1.2710251084841244,0.8518605838119584,1.315288318689388,2.2286974204427676,1.5682563087047336,1.208497670431369,-0.6627184677903932,-0.9392434472345703,0.16807308257280318,-0.23439963317630227,-1.378292927019231,-0.07101913660667225,1.2900627237196505,-0.9007385435250881,-1.1218186624946322,-1.5094148374134844,-2.2136755867386455,-1.553269982885002,-1.6428798852793003,-0.862900453632657,-0.845303210547703,-1.9978769217419097,-2.729997347495413,-0.9001859766116131,-1.5956105312079853,-0.31551253076490016,-1.1040590702699946,-0.4018892868218467,1.6323918922167713,0.8870128098634706,0.7254889080442779,1.1743113908517175,1.1350417907017532,1.3482111201193816,-0.21070485102874503,1.4114644118112252,0.6283426602562032,1.223040199909021,0.7724774913653603,-0.802721391641211,0.2530571371376257,0.2586408492045197,-0.4100213426959791,-1.5452499661389192,-1.1244751303830893,-2.7260070649856285,-0.5067059441206374,0.037039124495860665,-1.223295462561131,-2.205146106079482,-1.5379152577388415,-1.645384144725765,-2.090027085984133,-1.6831083727336527,0.35078426493275217,1.820910145002096,2.6800290242027245,-0.17164058063604504,0.27289065148940933,1.1949087256475184,-0.3019434028219442,-0.2440648127798274,1.0873657220678692,0.533059869273139,0.008657463073998783,-0.32029690585117926,0.7967099271317087,1.7839859742874942,0.7464214113264818,0.27692726899088804,-0.5660101771283441,-0.5300508739856581,-1.2885653770778842,-2.456048941057687,-1.3300906167694655,-1.3992359581444869,-1.4226924233479328,-2.5698110379145103,-1.3021600110996585,0.27766252095147426,-0.32472375536399856,0.6668183865901071,1.147544996175446,1.185565063578921,1.232417067174513,2.60678713526626,2.837965774069057,2.1826349697648406,2.545969820298157,1.2832249720981241,0.358194242708303,1.5317832212651215,-1.8586710238618565,-1.0675363184001427,-1.449736436239187,-2.293284121987626,-2.1325592979141073,0.8718817478963534,1.0039877985800243,3.577388554779036,2.283740028961077,2.103647510474474,0.7941905515216027,-0.002648474372262233,-0.15934711467057985,1.1887325187117526,0.5726218605653299,-0.1117396171999826,0.03955333307100972,1.7615737929142208,0.6038002513984034,0.20753057615158887,0.2527390192438926,-0.23852996462811024,1.1136273826696343,0.9214602489266817,1.1059974972040463,1.6519828823984382,1.6096280451107905,1.1616930513059598,-0.8448798414903463,1.3348991621206867,-0.2667348296953702,-0.6525981175111227,-1.1557699401835562,-0.9558795894993004,-0.6298896173053821,0.8794417185533951,1.030436610820817,1.4095118187198967,1.4033866760152074,2.949989396537098,2.7897954192782173,1.7167659661337462,1.3067428495564661,1.1372940950851145,0.44691418624615337,-0.07955426118568132,-0.3356209145397714,-0.02047509250846613,0.7133322840860488,0.964131775290353,1.2455623519540637,1.7640478399353503,1.0138189076204238,-0.8307437952280771,-0.41096723541910796,-0.4041573427608195,-0.8993710172248973,0.3271003729622791,-1.979079064914625,0.2775865714536534,0.5177458952677083,-1.4810936592578217,-1.8492757004984677,-0.4962692585062074,1.9640373849362693,0.724203389571637,1.814691732381388,2.6776343881078546,2.116424767806089,1.4377646620225386,1.286934585255985,1.854082573757037,-0.7928408792719319,-1.324222060775732,-1.195992786315224,-1.94729295141122,-3.0607800731361543,-3.952080175089354,-2.8100863227887385,-1.7047010182490292,-1.991922939294755,-1.4238001301307919,0.3592165937626469,-0.20393717362584907,-0.43074833747046914,-0.80754924243218,-1.2384075903197111,-1.3959006166478458,-2.1257406352198642,0.04593257546133689,0.6520890396345401,1.1179608290615224,1.0276012718503902,0.22991002213523903,2.6619215347883185,2.400995642324517,1.46734766074375,-0.06719125442799356,-1.3137875336306593,-1.9219527473772917,-0.49519862612103116,1.1766580031402456,-0.45625204704715383,0.34918009356443924,-0.05759794390003778,-1.2621406298893028,0.6460401732209827,0.5814477829911457,-0.9017588394097723,-1.3679388222584015,-0.9685401572723481,0.41385608531696527,-1.8739068874734714,-0.20651193592402994,0.08444767933728184,0.5741058093159997,-1.1539337007091142,-1.5265851793830016,-1.2704130242220826,-1.6942456145626612,0.5455900444929207,0.9417838655993787,0.828340915052175,-0.03675295075139917,0.07283878229791826,0.9943550981624216,-0.8817024309814544,0.08135311938409129,0.058341488956469054,0.8482986418133194,0.9273022152049752,-0.23754153634879205,-1.3539995092105248,-0.5110156604126674,-0.7290367892005738,0.32199348587248855,0.6450707334279238,0.24853339243453593,1.2486344045281255,1.013842203768838,0.561258785275262,-0.1690331358734592,-1.0060668091691316,-0.44927799874341157,-1.2938101446693104,-1.5252202447495036,-0.5994653407178623,-1.2855642730473453,-1.9433526402160664,-0.8441623395768243,-0.8466770570003823,0.02256005033671682,0.019862842030105708,-0.6497964756695055,0.9085036121736597,3.720385220286871,2.0217990687507124,1.7596561539030182,2.0162274626283483,2.043553823426699,2.392626414970274,1.5536334253669735,1.384750954333548,-0.4987839384743715,0.5423613792397206,1.1238298108522888,0.9514550119794211,0.0037458207126919163,1.2755145597112632,0.9205095445163592,0.23857873207889974,-0.1914168849728894,-0.5211315343211544,1.348781436683769,1.877130079619389,2.1260897143928874,2.012188433918652,3.098141784228164,2.073408055704519,1.6813826215658092,1.7558896819261158,0.8054074198122103,2.439295867565842,1.7317430975098307,1.4650944174727845,1.4037192088578414,-0.12820594428423493,0.00873741428268765,-1.1449091062538017,-0.42702861515649376,-0.578718879156514,-0.9972610253317271,-0.5003624554230697,-0.9419360359832316,1.3229248461572451,3.6072090412344657,2.267523045936958,2.3750725053028727,2.9610862464402805,2.4528362233118224,-0.3128431547592143,0.038880662483247175,-0.08095878916353444,0.7267297656778984,1.4462422477597405,-1.2954954055180863,-0.9570416343295537,-2.959856294211212,-1.3750438967709402,-3.4931321978029812,-3.484475394048755,-1.3994098017447887,-0.9692415041934561,-1.473049927836069,-0.35798794105427745,-2.61828365707488,-2.9196839106840478,-3.4347361491361195,-1.0578543725928231,-1.6565077762944929,0.8939243970366733,-1.822728312666174,-0.6976432917055373,-0.46224807019968617,0.03160738438161104,1.040137201034959,2.0868098997782702,1.6080042319844892,2.1683041084357364,1.5387451628659403,1.7208655296229505,2.1580713357096872,0.8042558470201001,1.7288010689293993,1.2034756306613654,0.3881941170834015,-1.0369500816490846,-0.4061782472388619,-0.7321544548539904,0.6466681732929775,0.9808511109476524,0.8955605441309686,1.1574321813894395,-0.2536485660335177,-0.012041917436470012,-0.8779778445977741,-0.25249149900823953,-1.2775145116100572,-0.5391258641695371,-0.9278737720010348,0.9490337611040863,-1.6102597807366679,-1.0685117040474137,-1.9718962663778794,-0.9666384410816324,0.6702762458021937,1.615020413005643,0.15434176240226727,0.39186443068747473,0.3785915003676036,1.0475331599691264,0.8245353440887676,2.058635046933647,1.44015389859472,2.1626887615200383,-0.7450042128812551,-0.8171845765821981,0.7522782481750793,0.9501574746995987,1.828115083523263,1.9517827595423516,0.1825322769497939,0.23972499630052682,0.9677342254877876,1.6847826517628401,2.6625168390919063,3.428184916140693,3.355375804270818,0.6915218534063796,1.179586682588182,2.1938230661092866,2.0501670673801193,1.283888418576665,1.492592639447833,1.6632642893564757,2.459201553937329,2.2988978999894587,1.351182519058428,2.7603271951339168,2.3761221736367744,0.7372107607621167,-0.4010905647304105,-0.8087144673803424,-2.3448639295155687,-2.9519540308754397,-1.8016736394654946,-0.8894475976577583,-1.3083514541140526,-1.0308319007366589,-0.3695706371851908,-1.9797803912699288,-0.6557681159918802,-1.2000720783051688,0.5512366101864564,2.44322961588648,0.9446453096932392,1.0892182138983233,0.9093488103884695,0.7152314030793301,-0.539211753690901,-1.240597767401229,-1.8555223615978123,-1.8035857660256038,-1.4552349919865692,-1.8182267659704028,-0.7219790445733977,-1.4765080720166064,-0.8138372185037139,-0.355446264748424,-2.4147529893459745,-2.399169182713907,-0.9487298609409531,0.3522344133012447,-0.0752879799562812,0.22677090110373482,-0.41668305136763806,1.683777095314203,0.921407091365058,-0.3728211116647856,-1.2808184245242713,-0.4794699744922534,0.25980148795725433,0.8845954514249643,0.9139509475465036,1.3917459424393743,2.0160304699879097,2.143780173394897,1.6429012127236724,0.8175623252851056,-0.3961350315141162,-1.6776629455961245,-1.8684946460711718,-1.3872476714973414,-0.821831930404432,-1.455911116910315,0.40929569930732446,1.7088394186118034,2.4270481672715745,1.5983146313370244,-0.9745146122681909,-2.5646798268581152,-0.3893845376118583,0.2691084442261279,0.7785921585518261,0.3073690527597278,1.3625275981960931,1.072687812106062,0.5536640267909809,1.4241201971853112,0.7760775187219952,1.2662081243851837,0.5249894009834084,-0.020862137575031192,1.9750952839543825,2.1172361507900197,0.10155196551189594,-0.479698844008908,0.026720950516609,0.28823709989007495,0.6910139082138641,0.6383124801188305,1.2872961446058913,0.14222015890576722,-0.7799942281481105,-0.11605518920711083,0.2091604938791593,0.340904481435631,-0.6565452630687932,-2.05116721625151,-1.4370597510262233,-1.7304918359178185,-0.6613035014497053,1.0781699623128271,0.030376028976465186,-0.22978492640037956,0.2833141662108255,0.4150401899357946,-0.5210427762648051,-1.6206715262956553,-1.141936691067715,-1.6931733485337768,-1.4554640761836828,-2.221390907431261,-1.6287838467463864,1.774339099267387,1.966808330314386,3.2832916544818067,2.598344364279258,2.9174912752667534,3.013390478585273,1.008938562226201,0.3612382981860659,-1.0111172652979583,-1.696696343215537,-1.6045592889347653,-2.0449662778020166,-1.2772948123551788,0.9538929012999745,1.3497396049082249,1.476632377615365,1.1439011733829902,0.30213571878027373,1.2796466608883386,1.982980507424875,1.7228333146292365,2.3648532701620537,1.35056476333157,1.1669540769043092,1.0044092590442069,0.10439482459753835,-0.26070138595886017,0.10045490396353798,-1.3056779273597343,-1.1237559912904171,-0.8522801195196434,1.2986576783858816,1.1923416948477563,0.1393598275910135,-1.7104117141795392,-0.8362615532126324,1.1992874205229094,0.5235722917146846,1.251064576784859,2.3600289902905547,0.19710357191309535,-1.4689488994945592,-1.7943758968588477,-1.0571820299537278,-0.3343332303201708,-1.2957358708150262,0.18432279742828495,1.3743251377099788,2.742161354558735,3.868858848011695,1.0573379172837465,-0.7080506171750934,-0.3026969405986733,-1.6298619766203262,-2.8397133793258376,-3.136117744340176,-0.7384073160140077,0.38412337055923873,0.542431667744936,-1.9654549251911282,-0.18472100628823362,0.2176222889850177,0.053863482679372604,1.9911461872039888,2.618497802475284,2.323290083578781,1.7328277145362263,2.1139590020826082,0.3877138149842778,1.346206442893143,0.12112431397193413,-1.7089408661908099,-1.238977079523199,-2.1329447868007216,-0.5507232019294781,0.4546578926475641,-0.6661794684960456,1.6082303805183398,0.6598308750067042,-0.6539874994676065,0.9059937719014615,1.2815811018451484,1.260151729397112,0.6497681125523405,-0.6406237093495958,-0.8010977783998281,0.24536494914579732,1.1729300401066272,1.4588392497346372,-0.7242084636603066,-1.5262668188862856,-0.5935870563736875,1.2138929628344806,1.7668985949014266,3.445275231411792,1.88700004143584,0.9065619904323361,0.3085926627778411,1.0164725890634427,-0.5684887232062944,-0.6874816656700158,-0.5892946582533289,-0.6292012375562348,0.3541827257308376,0.6691211354379735,-0.12008531418935081,0.30523566009146424,1.1727032578016776,0.2050174792952969,-0.16344976083616103,-0.7712167456573233,-0.9644181675536964,-0.025073793202104344,0.39336119877286924,0.207206054802477,0.5789535037920954,-1.6997215357350053,0.7729799267074167,-0.27211297565346015,0.6550694012054253,-0.5781274761410258,0.2505783278566039,2.05821847297855,0.9469979637548711,1.2362684166119067],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Random Walks (coef=0.3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('00167f9e-f544-4b51-ae75-98349033f902');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rw_acf <span class="op">=</span> acf(walks, lag<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF Random Walks (coef=0.3)'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>rw_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="2de21cc8-32f7-4f01-8334-4bc07c7fa0b2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2de21cc8-32f7-4f01-8334-4bc07c7fa0b2")) {                    Plotly.newPlot(                        "2de21cc8-32f7-4f01-8334-4bc07c7fa0b2",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0000000000000007,0.6869870977404627,0.45956375013302997,0.29561888231378675,0.16881229259020952,0.07609059084530279,0.006351892373035434,-0.04550754495424662,-0.06695160551073234,-0.07198688272327086,-0.07406599106055187,-0.046104297450834934,-0.014374270104425388,-0.02812358374058034,-0.0407242661550092,-0.028104810949017154,-0.0007716814221996855,0.024797344926737512,0.015514869771377093,0.025735292645534927,0.003914560892890826,-0.013707510710751573,-0.02436758006715491,-0.03292357708996194,-0.0059838377866318895,0.03449332285063373,0.04297502760014559,0.06297801414811582,0.09784659310406783,0.09428393182547552,0.1033500898047095,0.061128684933855225,-0.010575541194789715,-0.057068560928423676,-0.04772855036724147,-0.0656123336384761,-0.09428201182557043,-0.10514015442749314,-0.10789466201473231,-0.1250978083078033,-0.12269774765952561,-0.10678009661856379,-0.05407405959476293,-0.005076293221814693,0.01976421884442785,0.015186049594899028,0.031977075141421285,0.015678464040127033,-0.021680279927779024,-0.022652822239855194,-0.05050047531138656,-0.06918347288749654,-0.08782401489098936,-0.0720208349178309,-0.02869841001268755,0.0031848608540005017,0.020679647982925712,0.009067534535765667,-0.014539000213004855,-0.005325164536259456,-0.0014692268100550171,0.01425116746584107,0.026227177095674396,0.009652096081139531,-2.473108001840883e-05,-0.002464202363929527,-0.036290445774592665,-0.06232100977075251,-0.06755804330703151,-0.066717684662565,-0.023113705343098357,0.022956156482216963,0.05936070362865879,0.07042229861711372,0.062432836301506665,0.049211348741336064,0.04623389268534225,0.03717112483121758,-0.007138742713617637,-0.04494417534010913,-0.07013189437958488,-0.05196957929687772,-0.0634324260560721,-0.051759360741275566,-0.02631783556287607,-0.050925801190333596,-0.03264936816642122,0.0006375836701385704,0.010900665145067406,0.0023347997733045886],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF Random Walks (coef=0.3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2de21cc8-32f7-4f01-8334-4bc07c7fa0b2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>可以看到 ACF 前幾項似乎呈現指數分配速度的遞減，那麼他們到底有什麼關係呢? 接下來我們就用數學的方法來看看係數與 ACF 之間的關係</p>
</section>
<section id="ar1-平均數" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="ar1-平均數"><span class="header-section-number">2.1.3</span> AR(1) 平均數</h3>
<p>，在回答這個問題之前，我們先來看看 AR 模型的性質，這裡我們用 <span class="math inline">\(\gamma_j\)</span> 表達相差 <span class="math inline">\(j\)</span> 期的共變異數，我們有</p>
<p><span class="math display">\[
\begin{align}
r_t&amp;=\phi_0+\phi_1r_{t-1}+a_t \\
\mathbb{E}(r_t)&amp;=\phi_0+\phi_1\mathbb{E}(r_{t-1}) \\
\mu&amp;=\phi_0+\phi_1\mu \\
\mu&amp;=\frac{\phi_0}{1-\phi_1}
\end{align}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\mathbb{E}(r_t)=\mathbb{E}(r_{t-1})=\mu\)</span></li>
<li><span class="math inline">\(\phi_0=0 \to E(r_t)=0\)</span>，因此，對於一個平穩的 AR(1) 序列，<span class="math inline">\(\phi_0\)</span> 與資料的時間的平均數有關</li>
</ul>
<p>且根據上面的性質，我們可以寫出</p>
<p><span class="math display">\[
\begin{align}
r_{t}-\mu&amp;=\phi_{1}(r_{t-1}-\mu)+a_{t} \\
r_{t}-\mu&amp;=a_{t}+\phi_{1}a_{t-1}+\phi_{1}^{2}a_{t-2}+\cdots\\ {{\phantom{\infty}}}\\
&amp;=\sum_{i=0}^{\infty}\phi_{1}^{i}a_{t-i}
\end{align}
\]</span></p>
<p>是不是很神奇呀，其實 AR 模型就是我們最初時間線性模型的其中一種</p>
</section>
<section id="ar1-變異數" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="ar1-變異數"><span class="header-section-number">2.1.4</span> AR(1) 變異數</h3>
<p><span class="math display">\[
\begin{align}
r_t&amp;=\phi_0+\phi_1r_{t-1}+a_t \\
\mathrm{Var}(r_t)&amp;=\phi_1^2\mathrm{Var}(r_{t-1})+\sigma_a^2 \\
\mathrm{Var}(r_t)&amp;=\frac{\sigma^2_a}{1-\phi_1^2}
\end{align}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\mathrm{Cov}(r_{t-1}, a_t)=0:\)</span> 因為 <span class="math inline">\(a_t\)</span> 為白噪聲序列，我們將 <span class="math inline">\(r_{t-1}\)</span> 寫成 <span class="math inline">\(\phi_0+\phi_1r_{t-2}+a_{t-1}\)</span> ，因此兩者沒有關係</li>
<li><span class="math inline">\(\phi_1^2 &lt; 1:\)</span> 因為隨機變數的變異數是非負且有界的</li>
</ul>
<p>且根據上述的公式我們可以推出</p>
<ul>
<li><strong>AR(1) 模型是弱穩態的充分必要條件是 <span class="math inline">\(|\phi_1| &lt; 1\)</span></strong></li>
</ul>
</section>
<section id="ar1-自相關係數" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="ar1-自相關係數"><span class="header-section-number">2.1.5</span> AR(1) 自相關係數</h3>
<p>自相關係數 <span class="math inline">\(\phi_\ell=\gamma_\ell/\gamma_0\)</span>，我們在先前的章節中已經計算過 <span class="math inline">\(\gamma_0\)</span> (變異數)，因此我們只要知道 <span class="math inline">\(\gamma_\ell=\mathbb{E}[(r_{t}-\mu)(r_{t-\ell}-\mu)]\)</span> 即可，這裡直接給出結論</p>
<p><span class="math display">\[
\gamma_{\ell}=\left\{\begin{array}{l l}{{\phi_{1}\gamma_{1}+\sigma_{a}^{2}}}&amp;{{\mathrm{if}\ \ell=0,}}\\ {{\phi_{1}\gamma_{\ell-1}}}&amp;{{\mathrm{if}\ \ell\gt 0,}}\end{array}\right.
\]</span></p>
<p>因此我們有</p>
<ul>
<li><span class="math inline">\(\gamma_0=\mathrm{Var}(r_t)=\frac{\sigma^2_a}{1-\phi_1^2}\)</span></li>
<li><span class="math inline">\(\gamma_\ell=\phi_1\gamma_{\ell-1}\)</span> (<span class="math inline">\(\ell &gt; 0\)</span>)</li>
</ul>
<p>把上面的第二個公式慢慢迭代就有</p>
<p><span class="math display">\[
\rho_{\ell}=\phi_{1}\rho_{\ell-1}=\cdots=\phi_{1}^{\ell}\rho_{0},\quad\mathrm{for}\quad\ell\ge0
\]</span></p>
<p>因此我們得到一個結論</p>
<ul>
<li><strong>AR(1) 模型的 ACF 圖呈現指數遞減</strong></li>
</ul>
<p>相同的手法可以用在 AR(2) 或其他，但是這裡我們就不提供證明過程了</p>
</section>
<section id="ar-order-估計" class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="ar-order-估計"><span class="header-section-number">2.1.6</span> AR Order 估計</h3>
<p>那我們要用什麼方法估計資料到底是 AR 多少的模型呢? 如果是資深機器學習或資料科學家，他們應該會說使用交叉驗證來找到最好的 p，當然沒錯，但是我們必須注意到在時間序列的資料中是有順序性的，統計學家們較為常用的方法是使用 AIC、BIC 選模型，簡單來講，就是跑一個迴圈去檢查每一個 p，然後選出最好的 BIC 和 AIC，我們這裡簡介 AIC 和 BIC 的使用時機</p>
<ul>
<li>AIC: 收斂速度很快，可以有效保證收斂到真實值附近，但是較難趨近真值</li>
<li>BIC: 需要大樣本，在大樣本下，BIC 可以收斂到真值，但是速度較慢</li>
</ul>
<p>因此假設我們的資料是 AR(3) 模型，AIC 可能很快就可以收斂到 2~4 之間，但是比較難到達 3，但是 BIC 不一樣，你只要給足夠多的資料，他就會趨近 3</p>
<p>除了使用 AIC 和 BIC 之外，我們也可以使用 Partial Autocorrelation Function (PACF)，在介紹 PACF 之前，我們先想一個問題，假設我想要調查時間差為 K 期的相關性，我當然可以直接計算 lag-K 的自相關係數，但是，我要如何保證這 K 期的相關性並不是 K 個 1 期時間差的影響組合成的? PACF 就試圖解決這個問題</p>
<p><span class="math display">\[
\begin{array}{l}
{{r_{t}=\phi_{0,1}+\phi_{1,1}r_{t-1}+e_{1t},}}\\
{{r_{t}=\phi_{0,2}+\phi_{1,2}r_{t-1}+\phi_{2,2}r_{t-2}+e_{2t},}}\\
{{r_{t}=\phi_{0,3}+\phi_{1,3}r_{t-1}+\phi_{2,3}r_{t-2}+\phi_{3,3}r_{t-3}+e_{3t},}}\\
{{\vdots}}\quad \quad {{\vdots}}
\end{array}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\phi_{i,j}\)</span> 表示第 <span class="math inline">\(\text{AR}(j)\)</span> 模型 <span class="math inline">\(r_{t-i}\)</span> 的影響係數</li>
<li><span class="math inline">\(e\)</span> 為誤差項</li>
<li><span class="math inline">\(\phi_0\)</span> 為常數項</li>
</ul>
<p>我們最感興趣的就是 <span class="math inline">\(\hat \phi_{j,j}\)</span> (lag-<span class="math inline">\(i\)</span> PACF)，<span class="math inline">\(\hat \phi_{2,2}\)</span> 表示添加 <span class="math inline">\(r_{t-2}\)</span> 後比起 AR(1) 模型增加的資訊量。有很多方法都可以求解 PACF，包含 OLS, Yule-Walker, Burg”s method, Levinson-Durbin 等等，以下提供 python 代碼</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># source https://www.jianshu.com/p/811f9ea0b52d</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.linalg <span class="im">import</span> toeplitz</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yule_walker(ts, order):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Solve yule walker equation</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array(ts) <span class="op">-</span> np.mean(ts)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> x.shape[<span class="dv">0</span>]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> np.zeros(order<span class="op">+</span><span class="dv">1</span>, np.float64) <span class="co"># to store acf</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    r[<span class="dv">0</span>] <span class="op">=</span> x.dot(x) <span class="op">/</span> n <span class="co"># r(0)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, order<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        r[k] <span class="op">=</span> x[:<span class="op">-</span>k].dot(x[k:]) <span class="op">/</span> (n <span class="op">-</span> k) <span class="co"># r(k)</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> toeplitz(r[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.linalg.solve(R, r[<span class="dv">1</span>:]) <span class="co"># solve `Rb = r` to get `b`</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pacf(ts, k):</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' </span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute partial autocorrelation coefficients for given time series，unbiased</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> [<span class="fl">1.</span>]</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        res.append(yule_walker(ts, i)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我們同樣使用隨機遊走的範例說明，可以看到除了 lag-1，其他相關性全部被壓到 0 附近</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rw_acf <span class="op">=</span> pacf(walks, k<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'PACF Random Walks (coef=0.3)'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>rw_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="e4ed9ffa-94d9-4d6a-a4cb-635fd65337fd" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4ed9ffa-94d9-4d6a-a4cb-635fd65337fd")) {                    Plotly.newPlot(                        "e4ed9ffa-94d9-4d6a-a4cb-635fd65337fd",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0,0.6876747725129753,-0.02354732109088726,-0.021675701376775155,-0.038623271398456976,-0.030454168761957796,-0.03519308283548289,-0.035210332481947874,-0.0037300947037279385,-0.005448023374530318,-0.01661738784816644,0.03713248510259344,0.020912668656891252,-0.06413529763554514,-0.02158541069132049,0.025583748226706872,0.03458156093901158,0.02112967449475987,-0.038002473929967744,0.0328667716694691,-0.05140096910359395,-0.012200255569197316,-0.003959455214782892,-0.011935604441350025,0.05477006560207014,0.05768798377452789,-0.011388505611780666,0.033941312405608146,0.05081469880159352,-0.021145361081526926,0.04557886609082785,-0.07145124916854236,-0.07699163275795165,-0.019055914218066163,0.06331109554007051,-0.04236432211101536,-0.06450280701355336,-0.011535682287098606,-0.009889788069622337,-0.06062086613694684,-0.012014429717023527,-0.003096546029914984,0.05656945742031839,0.03451068908239105,-0.001632829575952194,-0.04686591457538837,0.01523923021028458,-0.055442370080479676,-0.0320094634006867,0.030298936422964516,-0.058538167761663595,-0.008651644468078274,-0.02788755959384483,0.023719316784625494,0.03896377872247103,-0.009327074636419982,0.010865738553369746,-0.02720849662381643,-0.05392544104634192,0.03210346698006175,0.00882411544866187,0.034279620333599575,0.013719663685978472,-0.034623121111121195,0.010798964023699786,-0.002345589059992959,-0.06269839413860426,-0.0035862149451040947,-0.013154775452548027,0.016965983525069193,0.08038130952212039,0.019093556507005695,0.010278244096707898,-0.03152242922177928,-0.03019092895814566,0.025694491692508613,0.01477602477655317,0.0006554744443341969,-0.05831489142548843,-0.032194187922068004,-0.02196063865915751,0.04205122422831974,-0.04812550974049696,0.025993724395525955,0.004683701746396408,-0.08389087058032352,0.06209837563476047,0.029996181969463707,-0.017369415946531266,-0.06835351372910387,0.0358787047800449],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"PACF Random Walks (coef=0.3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e4ed9ffa-94d9-4d6a-a4cb-635fd65337fd');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>這裡我們就可以談談 PACF 的特性</p>
<ul>
<li><span class="math inline">\(\hat \phi_{j,j} \to \phi_p \quad \text{as} \quad T \to \infty\)</span></li>
<li><span class="math inline">\(\hat \phi_{\ell, \ell} \to 0 \quad \forall \ell &gt; j\)</span></li>
<li><span class="math inline">\(\hat \phi_{\ell, \ell}\)</span> 的漸進變異數是 <span class="math inline">\(1/T\)</span> 對所有 <span class="math inline">\(\ell &gt; j\)</span></li>
</ul>
<p>表示對於一個 AR(p) 序列，PACF 在 lag-p 會有明顯的截斷面</p>
</section>
<section id="ar-模型參數估計" class="level3" data-number="2.1.7">
<h3 data-number="2.1.7" class="anchored" data-anchor-id="ar-模型參數估計"><span class="header-section-number">2.1.7</span> AR 模型參數估計</h3>
<p>最後，我們來講講怎麼估計 AR(p) 模型，AR(p) 模型可以看成是一個多元線性回歸，只是變數都是過去時間，因此我們有</p>
<p><span class="math display">\[
r_{t}=\phi_{0}+\phi_{1}r_{t-1}+\dots+\phi_{p}r_{t-p}+a_{t},\quad t=p+1,\dots,\,T
\]</span></p>
<p>當我們把這 <span class="math inline">\(T-p\)</span> 條公式寫開之後，就可以使用 OLS 或者梯度下降方式去估算參數</p>
<p><span class="math display">\[
\hat{r}_{t}=\hat{\phi}_{0}+\hat{\phi}_{1}r_{t-1}+\cdot\cdot\cdot+\hat{\phi}_{p}r_{t-p}
\]</span></p>
<p>有了估計式之後，我們就可以計算誤差 (殘差項) <span class="math inline">\({\hat{a}}_{t}=r_{t}-{\hat{r}}_{t}\)</span></p>
<p>Note: 如果序列資料來自於 AR(p) 模型，那麼該模型的參數應該呈現出白噪聲的樣子</p>
</section>
<section id="ar-模型的預測" class="level3" data-number="2.1.8">
<h3 data-number="2.1.8" class="anchored" data-anchor-id="ar-模型的預測"><span class="header-section-number">2.1.8</span> AR 模型的預測</h3>
<p>當我們建立一個模型之後，當然是想用他去預測未來的資料，這個概念在時間序列中稱為 forecasting，如果寫的數學一點就像</p>
<p><span class="math display">\[
E\{[r_{h+\ell}-\hat{r}_{h}(\ell)]^{2}|F_{h}\}\leq\operatorname*{min}_{g}E[(r_{h+\ell}-g)^{2}|F_{h}]
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(F_h\)</span> 表示在 <span class="math inline">\(h\)</span> 時間點之前我們所擁有的所有資訊</li>
</ul>
<p>簡單來說，就是站在時間點 <span class="math inline">\(h\)</span>，當我們想要估計 <span class="math inline">\(l\)</span> 期時間後的值，我們會找一個 MSE 最小的 <span class="math inline">\(g\)</span> 最為我們的預測值</p>
<p>舉例來說，我們想要用一個 AR(p) 模型估計 <span class="math inline">\(l\)</span> 天後的股價，我們當然可以寫</p>
<p><span class="math display">\[
r_{h+\ell}=\phi_{0}+\phi_{1}r_{h+\ell-1}+\cdot\cdot\cdot+\phi_{p}r_{h+\ell-p}+a_{h+\ell}
\]</span></p>
<p>但是要注意到，我們事實上完全沒有 <span class="math inline">\(1,2,\cdots,l-1\)</span> 天的股價資訊，而這些資訊又是 AR(p) 模型必要的特徵，因此，我們只能使用類似於滑動窗口的方式，先估計一天後，兩天後，最後才到 <span class="math inline">\(l\)</span> 天後，這過程，我們必須不斷使用我們的估計值去取代真實值，因此距離現在的時間越遠，我們的估計就越不準</p>
</section>
<section id="ar-練習" class="level3" data-number="2.1.9">
<h3 data-number="2.1.9" class="anchored" data-anchor-id="ar-練習"><span class="header-section-number">2.1.9</span> AR 練習</h3>
<ol type="1">
<li>首先我們先來生成一組 AR(3) 的 資料</li>
</ol>
<p><span class="math display">\[
r_t=0.01+0.1*r_{t-1}-0.1*r_{t-3}+a_t
\]</span></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_ar_data(n, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate AR data with the specified equation.</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">        n (int): Number of data points to generate.</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">        mu (float): Mean of the random noise.</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">        sigma (float): Standard deviation of the random noise.</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">        np.array: Array of AR data points.</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize arrays</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    ar_data <span class="op">=</span> np.zeros(n)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    epsilon <span class="op">=</span> np.random.normal(mu, sigma, n)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate AR data</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, n):</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        ar_data[t] <span class="op">=</span> <span class="fl">0.01</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> ar_data[t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> ar_data[t<span class="op">-</span><span class="dv">3</span>] <span class="op">+</span> epsilon[t]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ar_data</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> generate_ar_data(<span class="dv">500</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">"Simulated AR(3) data"</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="e1d4668c-a666-4af4-bf8f-eacedd88c299" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e1d4668c-a666-4af4-bf8f-eacedd88c299")) {                    Plotly.newPlot(                        "e1d4668c-a666-4af4-bf8f-eacedd88c299",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"lines","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.0,0.0,0.0,1.5330298564080254,-0.07085038908253341,-0.2312219958574339,1.4127876302808455,0.9257985310892467,-0.34377233324028406,0.3769040472338517,-0.5083071411980018,-0.47218323436602866,0.16705354340604608,-1.8357441761973932,-1.8512739266961693,-0.7541202762511943,-0.8946687303398039,0.41990785223091043,-0.7806212626730005,-1.3908989545686112,1.294568088241602,-0.008257365395075406,0.21579236360527743,-1.5226257586770893,-0.685819563853384,0.030761396963999932,-0.9856548618581938,0.35571448854519094,-0.5581433807606859,-0.238942601683526,-0.6511723212522686,1.8529752904597796,0.20569456447639667,-0.9620242403830338,0.5510449590189077,-1.176308610516771,0.19743515799138167,-1.9850311039825281,-1.3990582982450062,0.04721189024548475,0.9516908794182117,0.4164431989562923,-0.06872515151715977,-0.39314529868282594,-1.5494808401313391,-0.8579197772561266,-0.49711621881711754,1.1723586883503379,0.5566461361291078,-1.6476639198681113,0.05208170857295008,-0.4255387231719323,-0.5447094806363408,0.5619971699199388,1.139753111805138,1.1097263783603464,-0.7744446023785978,-0.49063214726958815,0.1812275788405705,1.081112345244276,-0.31199978859390354,-0.22498171340726453,-1.2269443798711823,-1.2777010832083986,0.7172538854140846,1.5606598550993496,0.221825972250441,0.9639901065756598,0.31196905019526516,-0.6261054468106418,0.21238605016978376,1.5380782664634212,0.1905923322174548,1.5724642840187733,-2.6063065023342094,0.5522126209200574,-0.004978098071700368,-0.028874510039616552,0.0436520634395349,-1.9727058984497692,-0.4040550266785272,0.3223418624999402,1.717398820836487,-0.2961248335221459,-0.8603402724953962,-0.7495309529177249,0.8800615057625162,0.5127912874854756,-0.3935279797267187,0.3959084845644326,0.09538926905593609,1.0275367154111548,-0.6288902707926802,-0.39009010058262983,-0.5238708347315361,-1.4430130045260041,0.20082798667023863,0.3435251543200668,0.193767272527068,-0.225293204789464,-1.4622525779613673,-0.5762473078142025,-0.36780992682924335,-0.6828330041084065,-0.16194428129542954,0.4346374213679198,2.007932943758163,0.4015655353371982,0.2642432021196922,-0.2388148899300143,-1.9728092578257628,-0.24021912144376237,0.07008978678965162,2.6775320169468277,0.10941414905793656,0.31547977856044096,-0.26091699354388204,-1.1957111518797139,1.0017037214710052,0.8881951041882629,1.0094225726498447,-0.898615569676855,1.2341132435495874,-1.3693819957023066,0.5497804511977251,2.1320223465747925,-0.6303958909029784,-0.6743153638128423,-0.17098240595112224,-0.4475343056210136,-1.5179853252469497,-0.056137317123555436,-1.013164014876359,0.5340745616722407,-0.8504030463542236,1.576210501869753,-0.6690396983164858,-0.29392518140190177,0.6365036490425042,-1.0903099816980562,0.15782145457451396,1.2692745348356291,-1.361524782907859,0.042699234784066925,0.14722526424326732,0.942697876492423,-1.1369508467072464,-1.4388742241793278,0.29378435554972254,0.450058193458883,0.4493860921096976,0.3720083831529732,-0.6778297026090818,0.12953211768912562,0.27882484675229646,-0.6086859630902299,1.801952703066821,0.63614570654324,-1.0568203302393016,0.38067630530321744,-0.9902286103513237,0.8037437757312498,1.2109023260502072,-0.5905692247115574,0.8339448292000411,0.3850851772514817,0.9296256001907939,1.9163610597530227,-0.08226052775271639,-0.8449247771518407,-1.1556430133160096,-0.9131485335217676,-0.07392408505109689,0.45932386764313515,0.4239380394465093,0.8869694614857844,0.06576645126217193,1.4277169183388831,-0.20058208755264617,2.703534312708137,0.7632490872019316,-0.7507744389408247,-1.4063233732260085,0.27551516920039126,-0.1108338245117293,0.8535494489635199,0.5410410525498577,0.002358575049285924,-0.9219128054598283,-1.6511426104868332,-0.601865070620633,0.8984035678073918,0.4790483619596265,-1.127647435453962,-0.019424174474953426,0.3454701260853788,-0.7265456800471989,0.09301295538830334,0.042963001376292345,-1.056019429688274,0.2528841218406256,0.5917766384146678,1.2578308499855713,1.1642967248493976,-1.3104173593136181,-1.1846498608450418,0.2901406086392158,0.6838417477074922,0.7118968471613013,3.90490711450693,0.9029970473731108,1.1646756602017798,0.6899786180626872,0.6400894083747557,-0.35772786982304805,0.6641985717046939,-0.760414298204578,-0.2670872495781619,-0.5684921299573891,0.11106635621104145,2.362473927252429,-1.5641685868707662,0.5287366960663327,-1.7860895943082613,-0.48412396653318296,0.9976645307074146,0.3526554315970304,-0.9840668381162848,-0.9034768461423381,0.5639845211607389,-0.5655614957894343,0.26025012461726527,0.025198400249466416,-0.582524358001927,2.0696666410634066,0.8483658463994053,-1.872053566217474,-0.19771770595866045,-0.7563948200041946,0.9739992094175519,-0.6653490468950793,-0.09563186415598748,0.4080241716231032,0.9830925160219397,-1.0824239690379835,-0.47354604990705707,-0.6106091677538559,-0.5961477524452992,1.7631940700272726,0.6523620347390684,-1.1260329756166083,0.6389392424903879,2.130813917787765,1.3681499498915843,-1.4364488952138939,-0.8309603541664172,1.0570001187808225,-0.4483245642193091,0.4920830071409393,0.7281423422653485,-0.7992837809296172,-0.17866203486885573,-3.321947777782493,-1.2666540410195775,-0.3513673520082325,-0.9407251393874234,1.6750041940948506,-1.2175042233503244,-0.45772239509327384,-0.07253208163272112,1.565770503237876,-1.2235128613463244,1.0580656741835992,-0.03053742188584064,-0.8522111071019025,0.28107579613472056,0.24022101737552615,-0.4809736647110518,0.003597138905441666,-0.39897598470876866,0.13171711325147636,0.6849426719556502,1.704408681811794,-1.0705463419708172,1.9674844732636199,-1.9157802203773193,-0.22630848287623354,0.3789379108705912,0.5204636808598238,-0.5380223034469881,-0.28981827178903313,-0.5640291299237186,-0.5819654395918846,0.8303873802407394,0.5064571369814932,-0.5740673376033164,0.7691544036488451,0.3435692475433445,0.9146257773536262,0.6541759792940903,-0.7879343377469977,-0.720437051707032,0.6198323020231495,0.7611469294104796,0.137256804147603,0.07906983352122735,1.2194571861994996,-0.47335135063064027,0.5018552627548512,-0.2639528447783589,-0.18674135264199215,1.0399171904475057,0.9658033525106163,0.9387641065158994,1.3053634987611684,0.06495985625781427,0.6045725462691554,-0.37034585184265734,0.29063578167839493,-0.1515367308267606,0.12887687709430787,0.5889811349785049,-0.7341688966529459,2.016082698310735,-0.8533072251664789,-1.2161024456390854,0.8448923591050858,0.9714826523900923,0.8528783268550729,0.6391441060392786,-0.035480627481996,-0.9760902669195384,-0.07571887910215538,-0.6711855366741276,1.0156102064422923,-0.027924472947693887,-0.7511710904198682,-0.4880639713392095,0.37691750443647276,-0.4409156933183406,-0.8075055677643446,0.13524490427183056,0.31258263086773985,-0.3849343555079213,-0.513056231596298,0.1594860511112325,-1.3836423008354086,-1.4845223813004662,-0.8728450644936059,-0.15236742807766696,0.45412306092028454,1.618053029490941,1.0447016689588802,-0.09088066915956755,-0.1799095777677397,-1.1149904893104707,-0.11092411800748025,-0.2717600929441124,0.41704159997472534,-0.7644343717541024,0.48007908636017327,1.5490426616411226,0.13258755488266494,0.3769625689511906,0.5829359824421193,-0.3461856291298908,0.16177766200230861,-0.019523431262186204,0.14034231833560218,-0.7651533182221372,-0.0400528144370524,0.4899587779681843,1.5866548174140738,1.1319415892703195,2.2273807386417697,-0.6932749707652799,0.6997989807171182,0.04058382994588658,2.273188813288789,-0.6409593020979845,-0.8978761553851632,-0.9064991423114174,-2.14044970833115,-0.6400123769753597,-0.7224839850200921,0.30219035880731343,0.4459762493554268,2.003016862653438,1.1305064885706628,-0.4984506317408795,-1.1385614207877897,0.27501238057066046,-1.2328869057894882,1.832026217354184,1.3451415043996393,-0.20137281108579203,-1.9064744319348752,1.0387107805319613,0.01946851390915745,1.440410606557865,-1.5442576761917768,-0.7457476419638663,-0.20337212513398997,0.19106914887052076,-0.34638379239580497,0.6185487656213172,-1.0148724677075147,-0.1992283525524645,0.048517919894520686,0.6307778728189526,0.8046155006260315,-1.0390323337647183,-1.6910951913939893,1.038105752696507,0.5500278206257142,-0.5143742353545833,1.405903976717414,0.21126224990202863,1.2618608325894876,0.06311416699731633,2.055933116591516,1.8447480708434072,-0.06080075809446439,0.7698975634857573,0.5478908988493826,1.4395007232267334,-0.8879631446060069,0.5524660556529004,0.9797210200922045,-1.5619710699532932,-1.3847022252263945,-2.2656745022919607,-0.3297771776784245,0.8330347605507593,1.8222279783803002,0.29929529602564764,1.5852415991187807,-1.3938000961410433,-1.8626919785718237,-0.3903410566656792,0.4944113528868437,0.21301558505177365,-1.9971064358681314,-0.3282718183882859,-1.3485982408488593,0.7445233683319656,0.48387776476887345,-0.746632185765582,-0.6529824727464484,-1.1628995456404838,-0.09430583326066207,1.0210099844498168,-0.7573350933265137,0.44774358951125925,-0.5775842578662965,-0.7648977487163224,-0.21829449377731602,-0.989313346010476,-0.5660908650765974,-1.2226575297187767,1.9513907145455591,0.29701170993394427,-0.5377585840273135,-0.024935019123065255,-0.13452272259653078,-0.1706460133901447,0.6095956006167172,0.8419195423686299,-0.41924459203465003,-0.6687022599098167,-0.4161138773794887,-2.2916080932700686,-1.6674816455345773,1.2517374906290157,2.009302271891192,0.12864235218619868,0.4742474492114847,0.16774467227556533,3.0927910404641743,1.3914292705598457,0.004450868347661507,-1.254374457812077,-1.8610266930947648,0.026915879722980457,-0.6182217115307975,-1.2879732114412774,-0.7680617933589524,-1.0865320117972104,1.7172857550369716,1.140174511789043,0.22469801104200796,1.3406853644905294,0.10741939291776696,-0.8630120631406878,1.3127543345065356,0.6694435378435355,-0.874000594228034,-0.39901417095706515,-0.9724640242648173,-1.3826460739680144],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Simulated AR(3) data"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e1d4668c-a666-4af4-bf8f-eacedd88c299');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<ol start="2" type="1">
<li>畫出 ACF plot</li>
</ol>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_acf <span class="op">=</span> acf(data, lag<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF AR(3)'</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="5ea848f1-3fdb-4edd-896b-8a6954d89fe0" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5ea848f1-3fdb-4edd-896b-8a6954d89fe0")) {                    Plotly.newPlot(                        "5ea848f1-3fdb-4edd-896b-8a6954d89fe0",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.9999999999999993,0.10098267174069911,-0.012299733338092778,-0.09880923366774293,-0.08879849749029085,0.035505017245174415,0.04429459347316738,-0.017265438027354158,-0.09152536028045706,-0.036011127101140586],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF AR(3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5ea848f1-3fdb-4edd-896b-8a6954d89fe0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>可以看到在 lag-3 的相關係數最大</p>
<ol start="3" type="1">
<li>畫出 PCAF plot</li>
</ol>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_pacf <span class="op">=</span> pacf(data, k<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'PACF AR(3)'</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data_pacf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="f931330b-b218-4e63-aaf1-b9d9a5509abc" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f931330b-b218-4e63-aaf1-b9d9a5509abc")) {                    Plotly.newPlot(                        "f931330b-b218-4e63-aaf1-b9d9a5509abc",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0,0.10118504182434788,-0.02282119536269739,-0.09686006289507323,-0.07123077453400803,0.05030825627863442,0.0263481814277006,-0.0400715889975431,-0.0884247028487257,-0.0062145244343211605,-0.007853366434763427],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"PACF AR(3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f931330b-b218-4e63-aaf1-b9d9a5509abc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>同 ACF，可以看到在 lag-3 的相關係數最大</p>
<ol start="4" type="1">
<li>用 AIC 估計 AR order</li>
</ol>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.ar_model <span class="im">import</span> AutoReg</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>best <span class="op">=</span> <span class="bu">float</span>(<span class="st">"inf"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>best_order <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> order <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    ar_model <span class="op">=</span> AutoReg(data, lags<span class="op">=</span>order).fit()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"AR(</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">) AIC: "</span>, ar_model.aic)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ar_model.aic <span class="op">&lt;</span> best:</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        best <span class="op">=</span> ar_model.aic</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        best_order <span class="op">=</span> order</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Selected best order: "</span>, best_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AR(1) AIC:  1407.3539983067183
AR(2) AIC:  1407.2913499349963
AR(3) AIC:  1402.828223161296
AR(4) AIC:  1398.1094017600367
AR(5) AIC:  1397.0403557874909
AR(6) AIC:  1396.8567941625547
AR(7) AIC:  1393.7280505207527
AR(8) AIC:  1389.2987596911696
AR(9) AIC:  1389.2034251860591
Selected best order:  9</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>用最好 AIC 選出來的 order 重新 fit 一次 data</li>
</ol>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ar_model <span class="op">=</span> AutoReg(data, lags<span class="op">=</span>best_order).fit()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ar_model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            AutoReg Model Results                             
==============================================================================
Dep. Variable:                      y   No. Observations:                  500
Model:                     AutoReg(9)   Log Likelihood                -683.602
Method:               Conditional MLE   S.D. of innovations              0.974
Date:                Sun, 03 Mar 2024   AIC                           1389.203
Time:                        17:08:24   BIC                           1435.364
Sample:                             9   HQIC                          1407.331
                                  500                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.0117      0.044      0.267      0.790      -0.075       0.098
y.L1           0.0928      0.045      2.053      0.040       0.004       0.181
y.L2           0.0003      0.045      0.007      0.994      -0.088       0.089
y.L3          -0.0903      0.045     -2.003      0.045      -0.179      -0.002
y.L4          -0.0882      0.045     -1.947      0.052      -0.177       0.001
y.L5           0.0406      0.045      0.894      0.372      -0.048       0.130
y.L6           0.0287      0.045      0.635      0.526      -0.060       0.117
y.L7          -0.0319      0.045     -0.708      0.479      -0.120       0.057
y.L8          -0.0871      0.045     -1.929      0.054      -0.176       0.001
y.L9          -0.0058      0.045     -0.127      0.899      -0.094       0.083
                                    Roots                                    
=============================================================================
                  Real          Imaginary           Modulus         Frequency
-----------------------------------------------------------------------------
AR.1            1.2163           -0.5437j            1.3323           -0.0669
AR.2            1.2163           +0.5437j            1.3323            0.0669
AR.3            0.5383           -1.1338j            1.2551           -0.1794
AR.4            0.5383           +1.1338j            1.2551            0.1794
AR.5           -1.3244           -0.5728j            1.4430           -0.4350
AR.6           -1.3244           +0.5728j            1.4430            0.4350
AR.7           -0.6288           -1.2763j            1.4228           -0.3229
AR.8           -0.6288           +1.2763j            1.4228            0.3229
AR.9          -14.7478           -0.0000j           14.7478           -0.5000
-----------------------------------------------------------------------------</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>檢查殘差是否為白噪聲</li>
</ol>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_acf <span class="op">=</span> acf(ar_model.resid, lag<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF AR(3)'</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="1cab60b5-5244-4480-ab83-b77c55ad3466" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("1cab60b5-5244-4480-ab83-b77c55ad3466")) {                    Plotly.newPlot(                        "1cab60b5-5244-4480-ab83-b77c55ad3466",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0,0.000484031755930371,-0.0016806191919387517,0.0018405175938266151,0.004469594584413491,-0.0026635930968989816,-0.00040271834177121597,0.01529885021695281,0.013750273444059642,0.002138303174270592],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF AR(3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('1cab60b5-5244-4480-ab83-b77c55ad3466');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>可以發現在 fit 完 AR 模型之後，殘差的 ACF 圖中相關性已然趨近於 0 點附近，表示殘差之間並沒有相關性</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ts_intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">什麼是時間序列</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>