<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Time Series Note - 2&nbsp; 時間序列模型</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./ts_intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.29.1.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ts_model.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">時間序列模型</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Note</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">序言</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">什麼是時間序列</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">時間序列模型</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#auto-regressive-ar-模型" id="toc-auto-regressive-ar-模型" class="nav-link active" data-scroll-target="#auto-regressive-ar-模型"><span class="header-section-number">2.1</span> Auto Regressive (AR) 模型</a>
  <ul class="collapse">
  <li><a href="#arp-模型" id="toc-arp-模型" class="nav-link" data-scroll-target="#arp-模型"><span class="header-section-number">2.1.1</span> AR(p) 模型</a></li>
  <li><a href="#什麼時候該使用-ar-模型" id="toc-什麼時候該使用-ar-模型" class="nav-link" data-scroll-target="#什麼時候該使用-ar-模型"><span class="header-section-number">2.1.2</span> 什麼時候該使用 AR 模型</a></li>
  <li><a href="#ar1-平均數" id="toc-ar1-平均數" class="nav-link" data-scroll-target="#ar1-平均數"><span class="header-section-number">2.1.3</span> AR(1) 平均數</a></li>
  <li><a href="#ar1-變異數" id="toc-ar1-變異數" class="nav-link" data-scroll-target="#ar1-變異數"><span class="header-section-number">2.1.4</span> AR(1) 變異數</a></li>
  <li><a href="#ar1-自相關係數" id="toc-ar1-自相關係數" class="nav-link" data-scroll-target="#ar1-自相關係數"><span class="header-section-number">2.1.5</span> AR(1) 自相關係數</a></li>
  <li><a href="#ar-order-估計" id="toc-ar-order-估計" class="nav-link" data-scroll-target="#ar-order-估計"><span class="header-section-number">2.1.6</span> AR Order 估計</a></li>
  <li><a href="#ar-模型參數估計" id="toc-ar-模型參數估計" class="nav-link" data-scroll-target="#ar-模型參數估計"><span class="header-section-number">2.1.7</span> AR 模型參數估計</a></li>
  <li><a href="#ar-模型的預測" id="toc-ar-模型的預測" class="nav-link" data-scroll-target="#ar-模型的預測"><span class="header-section-number">2.1.8</span> AR 模型的預測</a></li>
  <li><a href="#ar-練習" id="toc-ar-練習" class="nav-link" data-scroll-target="#ar-練習"><span class="header-section-number">2.1.9</span> AR 練習</a></li>
  </ul></li>
  <li><a href="#moving-average-ma-模型" id="toc-moving-average-ma-模型" class="nav-link" data-scroll-target="#moving-average-ma-模型"><span class="header-section-number">2.2</span> Moving Average (MA) 模型</a>
  <ul class="collapse">
  <li><a href="#maq-平均數" id="toc-maq-平均數" class="nav-link" data-scroll-target="#maq-平均數"><span class="header-section-number">2.2.1</span> MA(q) 平均數</a></li>
  <li><a href="#maq-變異數" id="toc-maq-變異數" class="nav-link" data-scroll-target="#maq-變異數"><span class="header-section-number">2.2.2</span> MA(q) 變異數</a></li>
  <li><a href="#maq-自相關係數" id="toc-maq-自相關係數" class="nav-link" data-scroll-target="#maq-自相關係數"><span class="header-section-number">2.2.3</span> MA(q) 自相關係數</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">時間序列模型</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>一個廣義的時間序列模型都可以簡化為</p>
<p><span class="math display">\[
r_t=\mu + \sum_{i=0}^\infty \psi_i a_{t-i}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\mu:\)</span> <span class="math inline">\(r_t\)</span> 的平均</li>
<li><span class="math inline">\(a(t):\)</span> 平均為 0 的白噪聲，通常代表在 <span class="math inline">\(t\)</span> 時刻的新資訊，也被稱為時間 <span class="math inline">\(t\)</span> 的 innovation、shock</li>
<li><span class="math inline">\(\psi:\)</span> 白噪聲的加權係數，<span class="math inline">\(\psi_0=1\)</span></li>
</ul>
<p>從上面的公式也可以看出，時間序列的值等同於一個平均趨勢加上過去每個時間點的資訊，這個過去可以從現在到無窮遠，如果我們再仔細檢查他的平均和變異數</p>
<p><span class="math display">\[
\mathbb{E}(r_t)=\mu, \mathrm{Var}(r_t)=\sigma_a^2\sum_{i=0}^\infty \psi_i^2
\]</span></p>
<p>我們這裡暫時寫 <span class="math inline">\(\mathrm{Var}(a_t)=\sigma^2_a\)</span>，因為變異數存在，所以 <span class="math inline">\(\{\psi^2\}\)</span> 必定是一個收斂序列，也就是當 <span class="math inline">\(i\to\infty\)</span> 我們有 <span class="math inline">\(\psi_i^2\to 0\)</span>，這個假設保證了</p>
<ul>
<li>距離時間 <span class="math inline">\(t\)</span> 越遠的那些資訊 <span class="math inline">\(a_{t-i}\)</span> 影響會越來越小</li>
</ul>
<p>怎麼檢查這件事情呢? 其實我們只要確認自相關係數就好了，也就是滯後 <span class="math inline">\(\ell\)</span> 期的相關係數是多少</p>
<p><span class="math display">\[
\rho_{\ell}=\frac{\mathrm{Cov}(r_t, r_{t-\ell})}{\mathrm{Var}(r_t)}=\frac{\gamma_{\ell}}{\gamma_{0}}=\frac{\sum_{i=0}^{\infty}\psi_{i}\,\psi_{i+\ell}}{1+\sum_{i=1}^{\infty}\psi_{i}^{2}},\quad\ell\ge0
\]</span></p>
<p>我們省略了上面的證明，其實也就是簡單的把 <span class="math inline">\(r_t\)</span> 用 <span class="math inline">\(\mu + \sum_{i=0}^\infty \psi_i a_{t-i}\)</span> 代入計算共變異數而已。對於一個弱穩態序列，當 <span class="math inline">\(i\to\infty\)</span> 我們有 <span class="math inline">\(\psi_i\to 0\)</span>，因此，當時間差越大，自相關係數會收斂到 0</p>
<section id="auto-regressive-ar-模型" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="auto-regressive-ar-模型"><span class="header-section-number">2.1</span> Auto Regressive (AR) 模型</h2>
<p>接下來，我們介紹時間序列中最簡單的模型，AR 模型。AR 模型假設當前資訊只與前一時間資訊有關，公式如下</p>
<p><span class="math display">\[
r_t=\phi_0+\phi_1r_{t-1}+a_t
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\phi_0:\)</span> 截距項</li>
<li><span class="math inline">\(\phi_1:\)</span> 前一時間的資訊保留程度</li>
</ul>
<p>這個模型假設其實自動包含弱穩態的要求，我們可以檢查他的平均數和變異數</p>
<p><span class="math display">\[
{\mathbb E}(r_{t}|r_{t-1})=\phi_{0}+\phi_{1}r_{t-1},\qquad\mathrm{Var}(r_{t}|r_{t-1})=\mathrm{Var}(a_{t})=\sigma_{a}^{2}
\]</span></p>
<p>我們可以看到當我們給定前一時間的資訊後，平均與變異數都與時間無關了，因此自動符合若穩態的定義</p>
<p>Note:</p>
<ul>
<li>Markov 性質: 如果細心一點會發現，當前時間只與前一時間有關是馬可夫鏈的性質，因此，<strong>馬可夫鏈保證給定當前時間，下一期的時間分配完全確定，也就是不需要再往前看更多期時間</strong></li>
</ul>
<section id="arp-模型" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="arp-模型"><span class="header-section-number">2.1.1</span> AR(p) 模型</h3>
<p>前面我們假設想要知道當前的資訊，我們只需要檢查前一期即可，我們把這種模型稱為 AR(1) 模型，同理，我們可以定義 AR(p) 模型</p>
<p><span class="math display">\[
r_t=\phi_0+\phi_1r_{t-1} + \cdots+\phi_pr_{t-p} + a_t
\]</span></p>
<p>也就是當前時間與前面 p 期時間都有關</p>
</section>
<section id="什麼時候該使用-ar-模型" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="什麼時候該使用-ar-模型"><span class="header-section-number">2.1.2</span> 什麼時候該使用 AR 模型</h3>
<p>接下來我們會想知道到底什麼時後該使用 AR 模型，最簡單的方法其實是使用 ACF 圖判斷，那麼 AR(p) 的 ACF 圖長什麼樣子呢? 我們來畫畫看</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> acf(series, lag<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate the autocorrelation function (ACF) for a given time series.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">        series (array-like): The time series data.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        lag (int, optional): The maximum lag for which to calculate the ACF.</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">            If None (default), the ACF is calculated for all possible lags.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">        acf_values (array): Autocorrelation values for the given time series.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">            If `lag` is provided, returns a single value representing</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">            autocorrelation at that lag. Otherwise, returns an array of</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">            autocorrelation values for all lags.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    series <span class="op">=</span> np.asarray(series)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(series)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.mean(series)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    centered_data <span class="op">=</span> series <span class="op">-</span> mean</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate autocovariance function</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    acov <span class="op">=</span> np.correlate(centered_data, centered_data, mode<span class="op">=</span><span class="st">'full'</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    acf_values <span class="op">=</span> acov <span class="op">/</span> <span class="bu">sum</span>(centered_data <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> lag <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> acf_values[(n<span class="op">-</span><span class="dv">1</span>):(n<span class="op">-</span><span class="dv">1</span><span class="op">+</span>lag)]</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> acf_values[(n<span class="op">-</span><span class="dv">1</span>):]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>同上週，我們先定義一個 ACF 計算函數，接下來簡單生成 AR(1) 過程的資料，我們就拿隨機遊走做示範</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'Random Walks'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> []</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    loc <span class="op">=</span> loc <span class="op">+</span> np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    walks.append(loc)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> np.array(walks)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>walks, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="449abb91-eb72-42e6-9622-fe57c2810f9a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("449abb91-eb72-42e6-9622-fe57c2810f9a")) {                    Plotly.newPlot(                        "449abb91-eb72-42e6-9622-fe57c2810f9a",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"lines","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.9409134207236873,2.8958194459780957,2.689170234579814,4.282268995606315,3.811102544676925,2.3219039427441563,1.403088980780788,1.826379884087904,2.3498859661866254,2.9170993165057153,2.5885208406460896,1.5582378608812952,1.1353791485619167,0.3157183354657931,0.8603754429210537,0.6664445126764394,-1.228277711164914,-0.18558513592845327,0.7398830732027489,0.36184949487402834,-1.10895172120798,0.05608024669957423,-0.4029698524776594,-0.016677705370994333,-0.6528821195463834,-0.9258922320157735,-1.688782218417865,-1.3638880654405199,-1.613518432855447,-1.8800594405511877,-0.7852549804039439,-0.8715199186925668,-0.3745863138540921,-0.564102598199615,-1.5145968962347298,-1.911611467291674,-2.383900424774233,-2.339413111398985,-2.922398357721975,-5.08646834562156,-3.521008627492168,-4.966557554001626,-5.447418583888481,-4.014542325170755,-2.9634781840827245,-1.23662066072443,-1.881093090287026,-1.725570155218198,-3.0214720025705786,-1.9030932995919736,-1.39406419245591,-0.6891298840035317,-1.7773249980274106,-1.2261696997737312,-1.4337082872593199,-2.9592747025481794,-2.1521001507269224,-1.103940303700631,-0.5124397846806491,-1.3003020531512748,-0.7363865184461645,-1.2555587057844342,-3.1107121906717703,-1.3690161480293437,-0.8893220185153098,0.7414242891909951,3.1046641843387484,2.286432694069818,2.2873896649946355,1.379636359160342,2.9855596659841446,2.8964546833081157,3.0172376418396913,3.311225904664656,4.75507047257937,3.9607869164249756,3.9109850811408,3.9308501479599514,3.7244113817402007,5.539081651751353,5.550044454810178,6.63965487084252,6.564106943562976,5.3394606170212615,5.1370389324853365,3.3767065744656857,4.888324989500859,3.573309499995122,3.808592944655013,5.2091150835441855,3.708956508680955,3.985082610859932,3.516077779749009,2.8869408344215763,2.4115238525135148,2.286161723366135,1.3664043634456429,0.7596375173053193,3.220481235198659,1.8597593078435917,1.3616855844817954,1.1608495401586212,1.528805975999059,0.6872247627421924,2.0332270017358214,2.593338549694922,1.9212593792734518,1.2988048442978337,1.2376398974226999,1.3734908150574467,2.2229847721157823,2.160613489999731,1.6797355503225768,1.135427506249641,0.36717026050274026,-0.24887051025168805,-0.5165972161117333,0.617064044962197,-1.2498701379221568,-0.1561723187754256,-0.7095506411319191,-0.6369133158100683,-0.9120494129630146,-0.5017685541825448,0.7206595337014069,0.252381988733937,-0.6543250948774131,-1.2900144034000753,-1.7815676640759666,-1.8960268796503814,-1.7244413191878996,-3.375277133107988,-3.649665323736947,-2.9328143970563616,-5.672090622490607,-6.2677496052017325,-4.840276329598262,-2.229943864713492,-0.33588804749498946,0.0761976740982776,0.6035145828508943,0.7392762593167018,0.4119437715032685,-0.26437912120812984,-0.5354319843225069,-1.139933909983097,-0.9037574901236767,-0.9598504563344779,-0.5712975018596507,0.9299323163453137,1.6669567583521134,1.8187906528075712,1.4657550689969134,1.6834013555159257,2.49530383939221,1.0258821444839719,1.3846072275787553,2.707855536386837,2.4114394396706627,2.821322719206372,2.670734776788808,4.3299250642232305,4.093134241714376,5.922492869654501,5.604391039379145,4.983842608719117,5.453696404311222,5.73731956315886,6.022296972772921,6.421613527304166,7.679079923747107,7.813617019316459,7.094711835222765,6.982838859545752,6.64305444416353,6.34504324800235,5.048893118048241,4.445556394312635,4.602435734067541,5.933240619211817,7.517900763009196,7.3710680326891085,7.021924062446203,8.529520475811383,6.940086809358414,4.764162199847904,6.006153323976747,7.562506032063271,6.884728726224614,7.607845458577533,8.994184492116355,10.263977590483957,10.273582107432492,10.19596792989721,11.692222217195006,12.536173287079437,12.700026649110963,11.939906936630045,13.634349677590967,15.349788905073005,16.678030432753868,15.876835075733872,16.387201089303435,14.855009143180261,16.136505637931528,16.65051777576117,16.342012918147198,16.10528041830274,16.895973331634025,16.9685417212426,17.94995980803506,17.823968196077224,16.99267194767732,17.58526440063986,17.032550962541833,17.057955416158986,16.307833101174722,17.126793143129508,18.579095091503646,17.358769677698334,17.719712005638968,17.998199128022947,18.760738264726363,16.94051309839329,16.625049719859817,16.655399229381814,15.934472361278475,17.972565620491796,18.162026229638872,18.355904240998413,18.446709943794843,17.23533259504751,15.952065142962006,15.62039727902335,16.995532044916033,16.755038049451056,17.186399119439724,16.875296133893325,16.20169425038074,15.778122001600961,16.29721505473655,14.24420059119944,13.432934382668362,14.851921022882204,14.801279468140704,13.057044111145657,12.769607858647,14.151374823660111,14.30437158991956,11.986647214767597,12.131119205531192,12.70623920770505,12.896747832763184,11.390615571526288,10.595798242372819,10.567077294237839,10.597906830158095,12.128908112081412,13.351428860684477,13.12683753345157,13.940619521026322,12.246938003568859,11.956985325577204,10.781206197751265,10.801084932828084,10.032503203672615,10.539025221371453,9.915453615025543,10.942457801463634,12.515823847585764,11.748846295955616,12.447321624219486,11.444758822490945,10.112047814733955,9.541911057059805,10.23537434477873,11.834754285598661,11.671949717661857,12.657691005511069,14.004738572705204,14.789674027070497,13.217036750603041,11.63369766470553,12.058936315113332,11.684148638581618,12.545080995500044,13.907329479743247,13.328406161391191,12.703478456992613,12.827535610104468,12.960017523205154,12.385689891872516,10.568200709570245,10.505981792704384,10.167848799613255,8.46983526551423,10.214064530845011,10.788839070105732,9.311056730403184,9.952866708363203,10.11833513653817,10.441619078615616,11.571493453436107,10.038369270020695,10.95788801168429,12.424206251173148,14.290617934959872,14.767467066590878,13.247252984604227,13.499679028102214,14.342714222168832,15.728082303122626,14.414634587929203,16.135246755748284,14.683549855604218,15.11477315282312,14.094109286586173,15.090290756401384,15.169757415412535,16.63946826734449,15.601224380319723,12.658969283435416,12.388641583676492,12.906777474766704,12.47362820628452,12.23583181382584,11.460608371710547,11.46135702154958,11.639182870147218,10.095444013700748,11.236007004754255,10.149312082756202,11.191165048804933,11.465167756162582,11.432533076896673,12.269793318142572,12.071759081883997,12.929646933892979,12.481981497123899,12.291185415690096,11.908622264483148,11.803080843014648,10.826318069738694,11.881629805549496,12.130674282144707,12.600415556007768,13.144032595789023,14.082586360061045,15.576801510440134,13.961231502047832,13.734295753363034,12.940812947659524,12.763351242695913,15.887853689892745,15.029596828425042,15.116489394417764,14.354218676303727,12.012958845355046,11.983373003470357,13.407941794064596,14.309924954551402,13.017369332400381,12.184826000989212,13.853342432601584,15.337630818404504,15.596330545864712,16.62606708818512,14.397065723577784,13.593006795860967,13.341665046208051,13.254959043939408,12.571389987992793,12.074380402904822,11.633483087448276,11.386643589990243,11.71866015837652,12.381719650061505,11.383982881275164,11.163513870344156,11.210891796702851,9.981111206935404,9.624026476806941,9.727529377101696,8.91687695647268,10.609230747526098,9.75837923439324,9.553844659557367,10.482311752541495,8.559067576374243,8.862024698403154,10.341170615358013,8.040278914142476,7.716514879345238,8.427998413450442,8.108694147651208,8.763350458181169,8.44802775125907,9.108364373856029,9.566106910491584,9.531737083345279,11.194814352602572,11.844405173988271,14.36879629852483,16.159234933892517,18.07088840816339,18.839311764897573,17.978455908358992,19.75216240498013,19.299467580850347,21.62685463852851,22.23745643829265,20.74049249372538,20.799821958151494,22.156815304774447,26.317223799586472,26.512757521513667,26.323274388991063,25.042697227004755,25.29301226380515,25.07295710228227,25.75478473688626,25.182929429608787,26.045836235514468,27.135697485080314,26.695664670035526,26.424083458005914,25.90047013506337,25.543840066776326,24.11867939556897,24.849100119312798,26.13284290216454,27.797536756634745,27.55152262411735,26.9486509966928,26.429411412543562,26.640827556083742,28.401795532821,29.046871082273697,28.134344277454975,26.143652409148743,28.235865000955286,29.579022031787556,29.236396125382008,28.77845382636682,27.401891019394995,28.245686393514692,26.559120490780504,28.249541650956225,30.553329301350058,29.848902051363737,30.574869089516795,29.501749394255793,28.494889151253474,29.292468869603947,29.151222181390516,28.259556529452556,27.748370828066196,28.613927840210504,30.004747777973428,28.599562183514852,29.357133848644235,28.748499056375465,29.250364646798488,28.272315396821625,27.751543757442878,28.266108105254784,28.89907946665481,29.952208425863084,29.787103679080527,29.507730009847275,28.543069934839938,29.31283932221472,28.527196596575273,29.075991673028817,29.933798974299552,29.186259192302796,28.43241789553976,29.186484131834217,29.471180797918798,30.261148070771824,27.63848964616626,27.495559497135986,28.09463773097997,28.906600523283675,30.558297348458012,31.33197206547955,31.24958091765846,32.88213405149878,31.936216439819596,31.933571620301908,30.02285646644231,30.794183051729348,31.10437710527884,32.84683639670885,30.993683398592864,30.60918443341191,30.563240135918377,30.254992607432936,29.470461991435553,29.268576638613,29.598733308400256,29.09504578887882,27.2992868609505,27.224377134573057,26.25421913068056,25.921043752035786,27.852176609416855,27.83231522833355,27.97398077244493,27.53250796090901,28.224119931804825,27.70562737948454,27.328896332554983,27.477377159627302,28.208027201612083,28.95072607439426,30.102076247655727,30.06524332656285,29.625855858634445,31.038891273165117,31.979649008190854,32.075660561076525,31.428844828451062,32.01945079778573,32.54792012741008,32.384836384828894,32.77504770149676,32.54323969849244,33.26429497024541,32.930937396054105,31.90241957045258,30.154503810593496,30.37611645678249,30.506414694203524,31.981373240382972,33.248071015485756,33.285521263860886,32.72069349322491,31.98236692376251,33.02096208309933,33.07992046747855,34.95327117863047,35.60550968535637,35.129118403308695,36.49401685870536,36.14799836898333,36.311966583879624,35.5793352775628,35.7035921196614,35.22058899164432,36.039893029487914,36.0261001091044,36.29118810776444,36.44291593608239,38.52185672230952,39.90082915055126,39.8584632043542,39.524714162784996,39.90269948576308,39.85114270063084,39.30091079689132,38.85096147307966,39.66478926676447,38.39359715716594,39.019958265421614,36.48865343459701,34.24705121996476,35.06244016734241,35.6509749680178,33.26564224453191,34.528873970840024,35.45038209529332,35.126749550301476,33.47686671800861,31.88631541371168,33.49869315951613,33.85545155831013,33.95376766304077,34.75706179341309,33.66252899656136,33.40978357253592,31.506934535140733,33.3403994419453,33.46174805500742,34.31271203396542,34.51389834185239,34.97106005385929,35.245755775473526,35.41488126103726,35.09922439160351,35.128739539015015,37.04253507688246,37.856599637523594,38.9370440590383,39.15750295603575,39.785254826685,40.53440857487092,39.84983256618425,39.56012676605743,40.718491650003536,40.59950519448366,41.32813162185099,41.44205185262315,42.4146174271103,42.01221982134289,40.92848599865823,40.38780022123715,40.09126144429308,39.17933273009753,38.648778720926245,37.65502259738891,36.646443150871306,38.069666569247374,37.80488594504808,38.423049333259556,37.7236135615518,37.92781303772483,37.37092321798265,38.96518716286388,38.88334790387678,37.256604678985326,35.81799820121725,35.89317439993066,34.72606973819453,34.2239988207094,31.483983797209103,29.720710334119158,29.429923724370482,31.11711631954522,32.86252713424359,32.57199150954631,34.40412093886161,33.842825722748934,35.238460050009486,34.3819222009043,33.628170868279405,31.618435218589436,30.969437092863842,30.94636228760221,32.00081322111477,31.439136062545945,31.964169804488435,31.503323478495712,32.49951077325058,33.06564988512128,33.86687852130383,33.42013270154389,33.948074589627126,32.62191983256101,33.388200846595666,33.49909299909712,33.50973298618121,34.00828487960262,34.406661615149886,33.964269856458344,33.869576502667854,34.73259225996974,35.1726444222145,35.16647526130353,34.80300374598777,36.67163931737459,35.982338316705444,37.126866530777534,36.474425988447216,35.992260278300165,36.7718612790748,36.05783973004361,35.9171079658436,35.92362164040102,36.65440954879525,36.92018074823913,37.93598808045633,38.48700377499973,37.53879078509735,37.541379685653155,38.305478881391664,39.18226862686541,39.73548295395801,38.17625092839453,34.92364055608023,36.42939071841964,37.32640127025856,36.67165609313278,36.34296507272734,36.14906438056347,34.13541625450744,34.412510088026096,35.119669977213,34.52894752740223,35.736067654054395,35.651737834536185,35.5856494808745,35.485323192721616,35.71352964341984,35.68759180891954,36.555390984281104,36.43227902011927,36.60477274524982,35.48836520204152,36.4189450997048,36.43560405563073,34.1948885689452,33.33458346667592,34.19222240954231,34.24228308752316,33.123811193487576,33.56224550279244,31.561676864642173,31.929921494976362,32.16860810236114,30.647090427273916,30.104975521977273,30.55464456595387,29.171121483960814,29.459375701893574,28.57366717048281,28.73826111062893,29.145616372659237,31.133056414036716,30.09415172861462,29.482188706070414,30.426640530482448,31.50801347449277,31.531425010873168,31.411283059874265,30.067055278248247,30.11270980246421,28.92036599230812,29.745066136832655,29.653188203474627,31.53849199924448,31.74881015106435,32.28937456875451,34.09424794174906,34.139758522694414,32.14374151722302,29.45346390365167,28.065020781715752,29.13593065479973,30.20980523411077,31.038606559480556,29.777226669577722,27.652367110734467,26.611700257594734,25.78367711093915,24.985237539941792,24.581578204698765,26.773148361028014,26.82654575712403,27.16912336382814,27.06708133561289,27.18725235355726,27.227185458103445,27.828992261765904,29.16622591548624,30.083993475677975,29.201834026614918,29.822752848835272,30.585024636579675,30.46594926986468,30.48669928605344,29.16581274611249,27.603525858705197,27.811823473865473,27.188874419329444,26.491157660134256,26.54179258088781,25.883289718439976,25.36453773934238,25.53203275808557,25.115187895695186,24.184451911538257,25.309694578851136,26.74327741528437,26.59314280562735,26.790267279097886,25.567071495922,25.196713093923883,23.528466486780363,24.855627220999207,24.03308890644484,23.296452650828392,24.02632975475181,24.89929881664028,23.879255702778295,23.465666781521506,25.45782757190968,27.397584508742327,28.212821696598958,27.097567190082742,28.67259084443823,28.722717667339523,28.731355149338867,29.195419384923227,30.57025793482196,30.657318746231333,32.36985268890661,31.25920963256126,30.65851008535218,31.27859308309527,30.898114271599617,31.402352875486294,32.3844230842259,31.56259114950443,32.28490544173156,32.12755150783512,31.26565071837015,31.278230764365713,32.35449902341772,30.598399019075444,31.20549530945067,28.413454272428176,28.60929280453209,28.69664237257753,27.9260289678847,30.110948008173224,31.281310363559808,30.54863535971604,29.739685503524612,27.515963850923377,27.271854904487093,28.685592732849038,28.781296019987728,27.770601932764233,27.954677310546852,28.712171150948606,28.417176587542077,26.47854739065569,26.087135100988956,27.29583674232675,28.343276072805,29.16746255591881,29.44706942029972,31.029005509013963,31.11596802315888,32.6686612214092,33.24641487640732,33.24608391706642,32.367658784765084,33.02833343953146,33.36047787564214,32.599238403179996,31.605323007147632,31.649329077911226,30.571896105812332,32.025906521647364,31.36247368225475,31.176401175916457,30.990527508752024,30.61267432554689,32.744032780780344,33.762728101027626,34.04167232938743,34.693304498723414,34.78975426788894,35.53271092759522,36.35475310203439,35.87545608490678,35.71735453519962,33.71938664988042,34.046115216718974,35.02990963981506,34.5546253672126,35.65580692056242,34.82811163610312,35.03532412935314,34.58265315405829,34.795766825920914,35.044176842127506,34.38865160772196,32.34810312106264,31.69485872049549,31.35692634398202,30.78056905147064,31.186375772450745,30.188893479353055,29.22100918209252,28.86383065582786,30.46833969364094,31.164498910268286,32.20448186134155,31.87796187290616,32.56938552529985,32.665881030595095,31.092195952714015,31.36544301822877,31.684780667629013,30.99147249034333,32.33410014613787,33.28515074781793,32.71392341491742,33.12854071417186,33.932905625600895,33.36541908411956,34.191912370195084,33.548045060403105,31.30627155513279,31.332625799687232,30.810788249684553,30.293228157993305,29.58141965062299,29.064749998731184,28.80495095251265,28.04825323799915,27.17919629781948,26.641187761485078,26.515176643505814,25.2776673870642,24.47058086376334,23.768177626948535,24.936745235246523,26.48573263441269,27.770990274083662,26.886859490392112,25.778660385973893,25.950745291149232,23.249589985152838,24.50217842750686,25.180241623165827,25.548904844718727,25.04088664539849,26.266418758406573,26.070320704961837,26.88276686000763,27.93070917822112,28.481012939880994,29.65209955695927,31.43191741294006,29.993785414424984,30.37234871033824,29.05983709853998,29.0209627754491,29.574444608977682,30.83617731365335,30.875030114848855,29.516851077010514,30.357785022608986,31.785388322156813,33.62025602324498,34.38685483084941,35.112404145650494,36.59411348346697,35.391015120638436,34.476301750533786,34.87614420168624,36.03088322430539,36.970181205428986,38.48178546702928,38.43661082171676,38.393402565667785,37.64463240611098,36.57715858795767,37.85700080241145,36.14581161918785,35.25761312323323,35.13561431116897,35.634919367397664,35.49651975901989,35.71527176530411,35.75897632110641,35.396251404814095,35.44042686272345,33.757667830141564,35.99489356213267,36.64651497136457,36.041917636879106,33.443965785050764,33.041257913932185,32.87564827399571,33.152235354075756,31.83711817477086,33.293786301077475,35.40365710963143,34.76622160214606,34.48165137311671,34.3709684661049,33.17092287955705,33.21402076244275,33.568890883342114,33.5489013058001,35.49894019799341,35.066031003736896,36.098716359444666,35.808772944267794,37.16845195417962,36.67328844276709,35.95831077870021,37.24952684599255,37.46164707981825,38.0656595625376,37.65701017847039,36.24522883735509,36.0662658158353,36.11386933514906,34.85651689558725,35.08841703807709,35.33163452400172,35.745315927057334,35.579660395115866,36.01612950699121],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Random Walks"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('449abb91-eb72-42e6-9622-fe57c2810f9a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>接下來我們畫出 ACF</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rw_acf <span class="op">=</span> acf(walks, lag<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF Random Walks'</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>rw_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="5c1f25c2-702d-401c-a0f8-bff2b7f12c9e" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5c1f25c2-702d-401c-a0f8-bff2b7f12c9e")) {                    Plotly.newPlot(                        "5c1f25c2-702d-401c-a0f8-bff2b7f12c9e",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0000000000000002,0.9951873461617686,0.9904024486437951,0.9858521950637092,0.9819035236929646,0.978085692900741,0.9740192651150227,0.969666200111423,0.9652359310542585,0.9606932798928155,0.9558602763452227,0.9508727721738249,0.945851568449103,0.9408728128553737,0.9357486495553741,0.9307499990869899,0.9259065433469037,0.92074004739736,0.915584542256605,0.9108128018928058,0.9061397885035262,0.9013716383537447,0.8965691555634769,0.8919953444155192,0.8875957803332042,0.8836294708011976,0.8798478701364585,0.8757466003928951,0.8717514908631757,0.8676443642092194,0.8635742557887693,0.8595775328284364,0.8554819420766859,0.851692335042006,0.8479260245327016,0.843820926531778,0.8394262605365996,0.8350827448395087,0.8310210381726291,0.8267580870808232,0.822220084657031,0.8180427338934279,0.8135839106088757,0.8088855422071792,0.8043024106546357,0.7998332469479426,0.7962235084416888,0.792469249493932,0.7884537263967059,0.7843131286746676,0.7799791923167824,0.7758715738206753,0.7717590415138292,0.7678032207812829,0.7640584871342534,0.7605320638840268,0.7574067121635731,0.7543344436816032,0.7509511857474077,0.7471164813559485,0.7429744934162877,0.7390441140129446,0.7348555229284432,0.7306687325763531,0.726790741414814,0.7231903558920598,0.7199057588125422,0.7170657879122609,0.7140945226829701,0.7111996473980747,0.7082811069771979,0.7052218550503052,0.7022680343498595,0.6992493915353727,0.6965962521343934,0.6945631694272717,0.6923497533165044,0.6903191043050475,0.687648891367624,0.6849174714847613,0.682375748123969,0.680047115790825,0.6782284016416459,0.6766489306803786,0.6751134400938654,0.6731596553525828,0.6709057719488141,0.668957524360077,0.6667673221120255,0.6647786763713571],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF Random Walks"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5c1f25c2-702d-401c-a0f8-bff2b7f12c9e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>看起來好像很平穩，但是我們調整隨機遊走前面的係數呢? 我們將係數調整為 0.3，也就是</p>
<p><span class="math display">\[
r_t=0.3*r_{t-1}+a_t
\]</span></p>
<p>我們在重複上面的過程，我們有</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'Random Walks (coef=0.3)'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> []</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>loc <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    loc <span class="op">=</span> <span class="fl">.7</span> <span class="op">*</span> loc <span class="op">+</span> np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    walks.append(loc)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>walks <span class="op">=</span> np.array(walks)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>walks, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="786c2d09-cce4-4273-8c72-c299f58845b9" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("786c2d09-cce4-4273-8c72-c299f58845b9")) {                    Plotly.newPlot(                        "786c2d09-cce4-4273-8c72-c299f58845b9",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"lines","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.4664732606833392,1.127089767207433,1.6468465500627434,0.7523411710356245,-0.1982889458128244,0.4324728652444102,0.682392243401833,-0.25278607902289413,-1.132057470221283,-0.06780482474438332,-1.3402268181277768,-2.0862200152313095,-1.0738605805577084,-0.8111404156906787,-1.5622359827987191,-1.7189856893233273,0.9688028012788381,-0.6956887624238951,0.3007310470900422,0.8887851654796217,0.21207467077442127,0.9807153694519779,-0.9541801925814379,-2.993294290591379,-2.190733805617364,-0.7595105455949133,-1.8746778347441633,0.9102318066386605,1.5626705741021092,0.505843687608212,2.348864828629554,2.7158194340625608,2.6642713572537833,1.9146299680491583,2.2298445485192704,2.497520982154435,2.936191219100187,1.6692076112947132,1.3035555326955293,0.4064763179645866,-1.1436155025336423,-1.1461660241843785,-0.06038157210665085,1.3044091221111898,2.0682607086870703,0.8021496026119563,-0.17721046926806272,0.3024737970934755,0.72019882500311,-0.38532697856597264,-1.3939395737226037,-0.8087514943817866,0.3668923702128595,-0.03355736200189208,-0.09776435109275225,0.5212499396184795,1.8241697713327198,2.584033977677022,3.2212417952356907,3.0988931970248474,3.6640076032713678,3.7108250993961303,2.87495070896969,1.702781899877062,1.6131974427093914,1.133348700567394,1.6329678746433753,1.4685996254209481,1.0256776395300868,0.39836675798492305,0.6924757258759573,0.04824242464461076,1.969132966061126,1.8657518377987368,1.4030700979173065,1.7894157734286842,-0.741733754434299,-0.7587623246705255,-1.2176521663799171,-3.9914161906354755,-2.9311791064002675,-2.9956388301172563,-1.2364921817399859,-1.6309404168172894,-0.6472436330676011,-1.620914319062152,-0.41236700151736994,-1.062079672864415,-1.2477599113943307,-1.5775596787936097,-1.597708918994389,-1.2431867527082323,-0.7623411411356681,-1.6403076373619419,-1.1106248992023278,-0.49246616748160643,-2.2142042632209193,-2.1713302492322484,-1.071076632407605,0.08018893422042128,0.32680947696606827,-0.2315828081957139,-0.3337509918565829,-1.2568662961261676,-1.35540821934321,-0.4941667197772885,-0.12467337573058909,-0.7109657800520816,-2.1427562473476947,-2.568246309325372,-3.174477092690484,-3.4781838076392493,-2.2232962789640744,-0.11984339961554458,0.19955465919893817,1.297467859157204,1.915331515472968,-0.5779932514916664,-1.3820333675461498,-0.7628255481076647,0.39992747167142684,-0.35081022360016917,0.7592439359398434,2.2082576214801923,4.926407969298053,4.0329903234112185,3.2432469748746993,2.3272332433568677,1.329527361637321,2.0522517062704275,1.5774031654129526,1.1719998173070785,0.13998425723691454,0.40279856149420784,1.829578043885058,0.5512605376285107,0.7976476694198094,1.5229774871641466,1.6948183919079112,1.3673574160226556,1.9183675252594647,2.855814407654904,3.2795384644727736,1.2546592555999998,1.5364846408999342,1.7179487249861003,0.8438551473599287,-0.3150370483904802,1.3758160762325788,1.1667726666705722,-0.8411787415885086,-0.3632081742409341,-0.33512537050016367,-2.8665610089453444,-1.6396820765068032,0.8603202526838327,0.17501769029731223,-1.1726401499354338,-0.9472438717566857,-1.7776228211277543,-1.9175208776395865,0.18089994630385142,1.058476333857624,0.42856103298807724,-0.09443120336822491,0.16343704658273925,0.4195414502407038,0.8107263772918774,1.3700011259819544,-0.8977596352019298,-0.12092710774524129,1.2993928286073722,-0.4146346114670094,-1.1780105477326952,-0.8286183727223373,-1.369596612346248,-0.7433956885172112,0.9003368570070719,2.260185710980715,0.6802015885590328,0.02681599365942794,0.23523473962618488,0.07266261923878659,-0.10862760499159206,0.11774793490861707,0.7907939927431002,-0.6719261769372502,-0.29814720686288876,0.48552544479389437,1.3628254870307879,3.1825032531786945,0.9168221784847961,1.3863196726123586,1.8521973143470973,1.5697493666064262,1.6188402117555643,2.2312050017234455,4.491749756042276,1.5728629657781823,2.191107510252473,2.9767032117106895,1.203561215774358,0.13910212274959233,-1.935325623516483,-2.001155195626806,-0.7452955735315965,-2.024658043248402,-0.7603069467465112,-0.144470185171385,-0.11405995760668633,-1.4644793989912266,-2.342979142366299,-3.176577601662264,-2.2253693768112064,-2.9853632561923575,-2.8891903054407497,-3.718812971046705,-3.4161591708679784,-0.4368249770089836,-0.8819236182076822,-0.37103573029113834,0.7851779598701578,2.350221972724955,2.1439400038566645,2.207989069525598,3.191702992556402,2.668550548302966,2.1116155352985917,2.3164167913073572,1.6422432274062235,-0.13584720033904274,-0.6371363212008644,-2.079321494103313,-1.2226651294349031,-1.7640540802302294,-1.5241739729403827,-0.36469683435112266,-0.31888808915408834,-0.047290185733084744,0.5554608292069616,-0.8623633776356421,-0.5852355127250258,0.688777985645042,0.5518332603411826,1.245524994836273,0.7979021852335069,2.3713622823906713,2.1993223716686425,1.6198015042386409,2.260899073145942,1.399793028161573,2.03079971961135,1.3969692744664655,1.0645399437563692,1.0678980698735827,0.670424848046645,-0.8947100166237083,-1.0628321586725524,-1.0682067015207073,-1.6907728859804085,-1.1873764861840217,0.08114342791758933,-0.34642853260719764,-0.8274866477191158,0.29750302212819757,0.4889454450422972,0.39335300124590156,-0.6104445915449193,0.8753088610392936,1.374329398446907,-0.06637146869019783,-0.7676548368143186,-1.542596803058375,0.40248055594891574,1.2835218962053307,0.6643170731646599,0.2164513591865169,-1.3561568637550612,-0.21941016650984757,0.8041056692061533,1.2064958639187737,1.577321931697722,0.21430963214724852,1.3100682009520885,-1.4836045306123051,0.41128224656177115,-0.46737191162548997,0.3470166649514479,0.34224689263380653,1.8191849561362738,2.4879018040567322,2.935723411294475,3.064197272550296,1.056693999946457,0.6468139263082902,-0.12929044281337576,-1.0124164864604979,-0.31203162472237483,-0.02710555884775004,-1.6315790364562965,-1.2914461836112707,-0.7243800267273564,-0.39693846703332103,-0.6142141094554991,0.008482706084314562,-0.3998632412034551,0.17148503926822473,0.9572658287199055,0.25596962451451183,1.1410097916524011,0.8301178682724107,3.112147614089924,2.795624039773154,2.00468674169449,0.037822445536557,0.3164566116216542,-0.45124736795248166,-0.5519244372302119,0.44040120850070374,1.522003322026626,-8.25036805949253e-05,-0.16660956090080098,-0.7991122833857249,-1.175347193015022,-1.7415720358048334,-0.9476876035230724,-1.1722987688702413,-0.6787129711087503,-1.3631335796799027,-0.11259658726947042,-0.2584858000242268,1.2806352209901646,1.4783996994239843,1.0128889919927018,1.8853019848834973,2.271378191478595,2.1618490517559734,2.860564977578816,1.3883119153587922,0.0025932140355487965,-1.8222039253894469,-1.3650424548272473,-0.6369639120771131,-0.3620794766981699,0.547347395683953,1.104825531670119,2.5397093702810634,1.331140778098788,0.9942627188290503,0.4749253163742756,0.6432493848100784,0.3311462150298459,-0.7776138154398902,-0.805530963262635,-1.1710926655565044,-1.259188037928427,-3.300661006017053,-2.063060224000807,-2.475521837329929,-2.673996570036877,-0.8673746846123431,0.6326768346024254,1.2073135015903023,-1.6311913712972212,-3.0965629377437325,-2.3817165708215207,-0.6235641690384286,0.06309192380160944,0.20410567410924368,1.2334231798251365,-0.14590038138043082,0.9455983229033937,2.1971421815818957,0.7010972265333627,0.8038713486383077,-2.4684034050324484,-2.203371291872857,-0.6427377466408096,-0.9176880413477053,-1.1766929630799825,-1.2668975838170267,-1.7671940245002253,-0.7261088679409738,-0.6847763176102293,0.3897807375610211,-1.9896491442566848,-2.1590723684356705,-2.090770831159629,-0.8706513221764466,-0.11115537309222384,-0.5396211403356175,-1.8385300964259232,-2.2365545820551684,-0.15758083207339735,1.5935175570402007,0.7284793227456203,-1.0574712767470533,1.0612944794501853,0.6603401472208077,-0.702529661408153,-0.274944265320991,-1.700099759311773,-1.842342786337119,-2.7234905985171545,-0.7246960836237593,-0.2610280908677632,-0.9320350931111527,1.5076332528010068,2.10399009117468,2.149515606702815,1.1478742455674407,-0.4897338054496595,-2.2028400725146846,-1.866674654684115,-2.215129547064939,-2.731177987810524,-2.1211192941471624,-1.221568999001903,-0.8326535380405677,-2.6163673313406526,-3.746630417878799,-1.607546532522893,-1.3448237125097353,-1.318966559822362,-1.3073261867995691,-2.7209193267559164,-2.263861158429183,-3.3994688588020305,-1.7960075817420724,-2.1380840972691253,-0.28100230886521316,-1.5527269706750522,-0.2989925495648782,2.401353866928815,0.607213920315046,0.2766229331124004,0.04253730715693768,-1.3894857902447737,-2.391166404578682,-1.6169876758121533,-1.6425425414124033,-1.2256442364530833,-0.3592170975761904,-0.28624066863413355,-0.7738045452294846,0.9095414795094279,2.194959265689005,0.7699954581962914,0.7834250269349752,0.502201389704456,0.16139707598229647,-0.45361994876024736,0.1736204472006786,0.41518339978956964,-0.01789010123004553,0.8548501566813413,0.24447900111943738,0.8863367388145368,1.1165371394898673,-0.5141165113524109,-2.080484737956777,-2.6549809227767587,-2.7088217645639485,-0.542626412554708,0.865081003476796,-0.8150200377025651,-0.8018595906812667,0.8269367386921512,0.6065845297337944,-0.33479852482376066,-0.8099429406195047,-2.2948351820892947,-1.7598190053887417,-1.5311343712890315,-0.188793175774706,-1.5875453921736273,-1.3374011693454397,-2.9193001680981894,-2.801304559891071,-1.7110264535096218,-1.600776284042999,-1.4429898650243673,-0.6134549073694215,-1.6486886367414513,-0.19360375510722172,-0.6589372196116052,-2.7501667526506797,-2.473810911736292,-0.47388012902305277,-1.4994510281159639,-2.5533004573295996,-1.4765994679069117,0.7446446259706263,-1.9079175963040194,-0.47965191802637197,0.5662637766845184,1.6101427735983116,-0.3037451960710855,-0.03096399447385334,0.43223755874685266,-1.396290713925026,-0.7445932097919433,-0.04386640272512493,-1.3140432640142155,-0.9667400515528319,-0.6716276970273,-1.894131083933814,-1.5098111195451243,-0.8618464483675172,-0.4021571120368558,0.24033812381484293,0.30019314377365536,-0.13854801786834123,0.7513104777922454,0.5599766025370522,0.4053415820770737,-1.0021019573257175,-1.0094369041007996,-1.2953806977616817,-0.7981767570499296,0.06799266937250203,0.27658755481668235,0.6226219115630034,-0.3944333409303814,-1.1578091823929821,-0.24703226388458077,-0.4790101685487433,1.1660098478469771,-0.1389137901627805,0.13822709934546507,0.9279625694764286,-0.5525406793833463,0.9584637100817048,0.01307540294719245,0.5594492965669156,1.1602397690460335,-0.895373247560327,0.7467309808077837,1.7338193102445656,0.17324632324230715,1.7882976313047063,2.533261314427526,0.6424822828144447,1.515561125575153,1.4473326916150775,1.1809332857127262,1.7535825359488277,2.217519969141205,1.2745231059509676,-0.6012414954806933,-0.6119405702630372,1.4652080924060413,-0.7692043476222503,0.4946502223007867,0.11692817286140816,-0.6850310324018387,-0.35238881177481707,1.4057344119555855,1.292584602573231,-0.025990553699317576,2.671793367453979,1.1167343090638637,1.191602398519356,-0.8072588127756718,-1.7310142659061067,-3.7447123046326736,-3.5759202100902114,-3.440447204550837,-4.896016142860486,-1.5020432610553713,-0.11008018712778656,-1.694251829357221,-1.1170061235069957,-0.4717467411942495,-0.857679875691655,-0.2633335794733778,0.22723582389347818,1.6612215600649791,3.3363453192338994,1.3232552654556753,-0.7797819261329242,0.027670364048007046,1.310357418792144,2.4714010546982825,1.408367447611937,0.3503229829229024,-0.6271172037014121,-0.7312641220531217,-0.2395930756542899,0.43797412825450466,0.41562778537602246,1.919195103213549,-1.0549005482884404,-0.17162757695682263,-0.4357791342266672,-1.000774337596317,0.5633460963599145,0.24982390252527722,0.4216305333073753,0.0804862269268369,0.3701527016846206,0.29186000917192867,-1.1427519118795322,-0.9398939336519155,-1.161385251894365,-1.1881063541650378,-3.726810136250455,-4.021049587531421,-2.0293199626416842,-1.0986685654103716,-0.691935900750478,1.7111932450272112,3.0737497950530344,2.760442639376353,1.9925652384434778,0.4702346448719795,1.2203146317672142,1.3064922571234405,-0.49265812362234085,0.49897518479596975,-0.57887201382156,0.2706552863164722,0.26443288392125747,-1.4826345474183475,-2.387392334616392,-2.4932152576755877,-2.8271479803787196,-1.9260660054590368,-0.5807141338831416,-1.5416874268787393,0.26084852820780435,0.5869573795782694,-1.2066011265510392,-1.079911225695485,0.7526785925359858,1.0831247212564004,-0.017627067614643277,0.6326152802249675,0.05692749806489378,1.1156582276682498,3.721541186730386,4.597883481440567,3.3231010050164445,3.0295876925563534,2.1627715919783745,2.453747846480674,3.166241290041439,2.5156163406667194,2.404794886497544,2.172609776409419,-0.3517124830966869,-1.5532411642517343,-1.2032507172933293,-0.47205662293789663,-1.70864683503453,-2.8481050627342066,-2.8096118465022464,-2.316465372377209,-2.163259770075008,-1.732015213329193,-1.1099689295106543,-0.9396696589972547,-0.583292257544821,-0.45838266528829863,-0.3193913415271183,-1.7921750699611572,-1.0789684620857303,-1.7218442609985316,-1.9897473151412344,-2.5692756602899935,-2.59188254775865,-2.8644166323182993,-0.019612592150983543,-0.4033933673570429,-0.4506291856934798,0.5645122868374914,0.044624317278766035,-0.8450696791563697,-0.656564195833821,-1.1355207028527672,-1.9357701059072656,-0.8445567722137488,0.1631085475878945,0.7738046323893955,0.5882218062247069,0.9733227268805026,3.00234458209188,3.9305932709605047,2.130933977631446,2.546325508671459,1.297879554018303,-1.9954103130116456,-2.986743133334746,-1.118029392590285,-2.239931985479175,-1.8294121079319532,-2.5715480775644615,-2.2540567432709673,-0.5945102175277743,-0.11143865230216693,0.5562863776386413,-0.9881705794216175,-1.3728244177620281,1.8820039096689594,0.7723248554616852,0.745750012616643,1.0205542020288063,0.26633146266592517,-0.8779605816880434,-1.3755819119453436,-2.2796858327430156,-1.1056196692274143,-0.786303744722105,0.29338292630847274,1.2735581737716266,2.1511752145730823,2.704527693036977,1.98478711880297,1.0214229326996238,1.5305525099684059,0.05358837645143533,0.48979321913647333,-0.38348971679829963,-1.0123707814669474,-2.3742787898281676,-3.012253420685612,-1.923047363378454,-1.5582593920239802,-0.28703235837978847,-0.753159976000934,-1.7433369653225927,-2.5251420823661244,-1.1910830412339726,-1.6055929498041168,-2.147749552547965,-1.473212845553851,-1.9273199714402476,-1.2433805615747655,-1.2260421650100506,-1.5528637282865025,1.0069445391270406,0.38317618505360673,-1.59629540011006,-0.5273434861215607,0.9518776469936476,1.4211589012141121,0.791545980788678,0.7181967500825986,-1.4133571520010713,-1.660245192670048,-0.6268638407978138,-0.5331568604285101,-0.30643952885653475,-0.22410001168705054,0.15117460844477942,0.4683809657850249,0.026661744919863395,-0.9077504865728454,0.348178317940802,-0.08889479678274384,-3.000705117905806,-2.389283070659067,-1.9121794919186414,-1.7873898237168764,-2.3644153798525744,-1.2919792096642968,-2.4813103400542724,-1.5219545328222401,-1.9338110357360523,-0.6484508523128145,-0.2653646514251426,-0.5562263119451809,0.2172649200681634,-1.0404938232144783,-1.8812462496345232,-2.6183110499706124,-1.6713967063521311,-2.732227166409581,1.2949532830064217,1.5652256832308695,-1.6070594039639305,-0.8198787654733234,0.0799931941080706,0.16894213075227654,-1.182217296274734,0.17795386900237464,0.03121007683713589,1.0428677746883654,0.4532987869241777,0.580815701884198,-0.8732279416713571,-1.898032106313823,-1.7391578762118578,1.3691980096978114,2.1170246407737885,1.4727830640093333,1.3415702948818997,1.2878995585551551,1.6871796708957305,1.6585327055887176,1.8167776915929692,0.6475203882105411,1.6343739836776023,0.04178111413362329,1.3238973976321737,0.6789765179489782,0.48610971719185847,1.03400300916712,1.667227961506799,3.556806977442348,2.5020121224918976,-0.07137724564770709,0.7133081132948598,-0.4425117803886301,-1.1718842153255973,1.4435798671105804,0.17281935920284563,0.9281425441169263,0.25671454331431476,2.3724570578375306,3.128694233376946,2.228549504603651,1.5464303261586072,0.6677869319615799,-0.12239755656870654,-0.8017006924262929,-1.9338557803407277,-2.494271875971174,0.18976993067212722,-0.9874417642432785,0.4643866355891294,-1.8081707386199162,-0.9601930468713076,0.8875231854421639,2.0773631632249705,-0.0008805654094445892,0.4322391751594369,-1.2292258314271094,-2.412978584591894,-1.7836359628145158,-2.035696959039605,-0.5116508161380365,-0.6742859875337203,-0.43052659670844334,-0.3893452355645097,0.4099282714258943,0.9889773072009123,1.2360330693520352,-0.04350983099062544,-1.4345954154967304,-1.2545087611283643,0.1105908485775755,-0.3331523777240665,1.846451678987035,1.0647603201430127,1.0145298661379698,-0.9748127581396508,-1.7565282910215894,-1.061662800616723,-1.6239592763057444,-1.4844783917829774,-1.7268340306101428,-0.9102618319738938,-1.6138867156975913,0.22074506432176721,-0.4162838116880637,0.9333560887637902,1.835433887138402,0.17006842988431514,0.22518270368811977,-1.5144417037876472,-0.3391766682653832,1.5046704766489016,0.04104898827562864,0.4465909805791549,-0.33515326292417613,0.10207254034005797,-0.7170983050458264,-1.8208434659826178,-1.8565148006482177,-2.622680913247825,-1.0633033186650902,0.2702445588036495,-1.407739573010836,-1.548064593620988,-0.6363919145559617,0.5768354216974287,0.547894299612771,0.6306194783385053,0.2692704978835644,1.2237269054794728,1.9850863707358561,0.4913521407835425,0.19995675336911897,1.1485561699117401,0.5434181387021153,0.5244048733645434,-1.1809293632668731,-1.5409018701222723,-1.0578084278964701,-2.0225062703000587,-1.3892742048324092,-0.5162546769420631,0.8917355082110342,-0.17306405711885398,0.8125949586806379,-0.20011523116377228,0.2634975572003738,1.8765690283177394,2.6379613029556546,1.4082599993275704,2.5024769097692614,0.5805147532435073,-0.19679389443593565,1.8792454792430213,2.823597154732607,2.243893238346334,1.2445293269321787,1.287622983959205,0.8211254678762708,0.5549853651667468,-1.084370767897195,-0.2856938144412421,-1.2736383607059092,-0.27556810507900353,-0.5477390704935923,-0.17109872237815543,1.2392799263064707,1.6902870655711706,0.22219990692165348,0.7279074181548131,-0.18728663086843866,-1.4316209270216196,-0.466445916228445,0.033916906554140536,1.3270133342577175,0.5973434170970225,0.7523321990750725,2.354207412457376,2.4921163499472896,1.9039422158468062,1.4640498148678458,1.4886057643149917,0.2195547192404278,1.2181137019921464,0.8884390342579627,0.5255968356701073,-1.1045899326283237,-1.2099682324956702,-1.6166726605238027,-2.047024680693425,-2.4739913527499304,-2.725095103544885,-2.6693648653587063,-2.667869220358399,-0.1825852053194561,0.49563970370624366,-1.6979224294572373,-2.2494029456092925,-2.315080725363784,-1.737391504615897,-2.3043586348941565,-2.4374521434108942,-1.2608651409148446,-1.167268151084906,-1.902419060225412,-2.919173475866393,-0.06029578224610144,0.44157803378747673,-0.2925157139185922,-1.5291972659261188,-2.4803217460280114,-1.0935758259769557,-0.917160878396211,-1.2780505528749342,-1.3151771929234457,-1.4286845408919606,-1.849469777977201,-2.07068332699079,-2.646508392110034,-0.5704043956266036,-0.2671153579487271,0.38487142240303746,0.06467255174709871,-1.3449444047732013,-1.0434974373067223,-1.1995845847169002,-0.22406920250965812,-0.07884719491193845,0.4755673646179266,1.0440049549321921,1.4974944310751606,1.698962568781004,0.10123626993538437,-0.13254736702518177,0.5615153880970198,0.2092866978597699,-0.7665480676535066,-1.1743188503217348,-0.08272513539487025],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Random Walks (coef=0.3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('786c2d09-cce4-4273-8c72-c299f58845b9');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rw_acf <span class="op">=</span> acf(walks, lag<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF Random Walks (coef=0.3)'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>rw_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="7d923f96-e399-4492-9a9a-2271f5afa997" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7d923f96-e399-4492-9a9a-2271f5afa997")) {                    Plotly.newPlot(                        "7d923f96-e399-4492-9a9a-2271f5afa997",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0000000000000009,0.7394154672251705,0.5323419092412505,0.4032550018707822,0.27674993366124534,0.17984456011464886,0.11530941847386286,0.06857267471796379,0.019737926864975493,0.01099931478928399,0.016511194365666178,0.028389693348221626,0.027108474888614877,0.021701757900074586,0.0024089438590909128,-0.01102012554627523,-0.022240696782509714,-0.03374486500102699,-0.04633382849221338,-0.05711484983975037,-0.06168082600380653,-0.03720740820961272,-0.01719700003750673,0.006999831926785953,0.03397099131918426,0.05380875304608219,0.07451939657474364,0.0551031515581288,0.05443186649358497,0.0291382332904725,0.0016084812158063645,-0.019479120209908253,-0.04208565552912432,-0.06990630763631453,-0.07854233499393723,-0.07427124209844478,-0.05742639204282299,-0.044406838165203584,-0.026543688994828316,-0.002734134782134594,0.0006277850662521942,-0.0030178780747635334,-0.016827600928638324,-0.048392987102345436,-0.08869169921341806,-0.10074033902726977,-0.09260494549571731,-0.08874024966238493,-0.09957973302283243,-0.08904578527981939,-0.06143362435406207,-0.04152417497096404,-0.013337858836006944,-0.009693244846927783,-0.0039027129786289878,0.022323325316980974,0.06517911606615176,0.05633261357849771,0.053518922661304286,0.0420326661467521,0.01891166757226778,0.03979729421660949,0.0662737470813757,0.08613175553293154,0.09433091887413955,0.08652304673485879,0.06387888334199655,0.03847391916706329,0.044444402079249455,0.034561434651735175,0.028376547750944562,0.029781433943490664,0.02084364406701801,0.0084576182317389,-0.0109518886719583,-0.03960972268339012,-0.07093047446284927,-0.08674919123445085,-0.09322708257655618,-0.07418928832034513,-0.0531674529300013,-0.021682641883509116,-0.00980278031208436,0.004219373638740196,0.021641314603195367,0.012273906053408827,0.03639781354333708,0.029129342255320937,0.018351692064479116,0.00975922344357852],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF Random Walks (coef=0.3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7d923f96-e399-4492-9a9a-2271f5afa997');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>可以看到 ACF 前幾項似乎呈現指數分配速度的遞減，那麼他們到底有什麼關係呢? 接下來我們就用數學的方法來看看係數與 ACF 之間的關係</p>
</section>
<section id="ar1-平均數" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="ar1-平均數"><span class="header-section-number">2.1.3</span> AR(1) 平均數</h3>
<p>，在回答這個問題之前，我們先來看看 AR 模型的性質，這裡我們用 <span class="math inline">\(\gamma_j\)</span> 表達相差 <span class="math inline">\(j\)</span> 期的共變異數，我們有</p>
<p><span class="math display">\[
\begin{aligned}
r_t&amp;=\phi_0+\phi_1r_{t-1}+a_t \\
\mathbb{E}(r_t)&amp;=\phi_0+\phi_1\mathbb{E}(r_{t-1}) \\
\mu&amp;=\phi_0+\phi_1\mu \\
\mu&amp;=\frac{\phi_0}{1-\phi_1}
\end{aligned}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\mathbb{E}(r_t)=\mathbb{E}(r_{t-1})=\mu\)</span></li>
<li><span class="math inline">\(\phi_0=0 \to E(r_t)=0\)</span>，因此，對於一個平穩的 AR(1) 序列，<span class="math inline">\(\phi_0\)</span> 與資料的時間的平均數有關</li>
</ul>
<p>且根據上面的性質，我們可以寫出</p>
<p><span class="math display">\[
\begin{aligned}
r_{t}-\mu&amp;=\phi_{1}(r_{t-1}-\mu)+a_{t} \\
r_{t}-\mu&amp;=a_{t}+\phi_{1}a_{t-1}+\phi_{1}^{2}a_{t-2}+\cdots\\ {{\phantom{\infty}}}\\
&amp;=\sum_{i=0}^{\infty}\phi_{1}^{i}a_{t-i}
\end{aligned}
\]</span></p>
<p>是不是很神奇呀，其實 AR 模型就是我們最初時間線性模型的其中一種</p>
</section>
<section id="ar1-變異數" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="ar1-變異數"><span class="header-section-number">2.1.4</span> AR(1) 變異數</h3>
<p><span class="math display">\[
\begin{aligned}
r_t&amp;=\phi_0+\phi_1r_{t-1}+a_t \\
\mathrm{Var}(r_t)&amp;=\phi_1^2\mathrm{Var}(r_{t-1})+\sigma_a^2 \\
\mathrm{Var}(r_t)&amp;=\frac{\sigma^2_a}{1-\phi_1^2}
\end{aligned}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\mathrm{Cov}(r_{t-1}, a_t)=0:\)</span> 因為 <span class="math inline">\(a_t\)</span> 為白噪聲序列，我們將 <span class="math inline">\(r_{t-1}\)</span> 寫成 <span class="math inline">\(\phi_0+\phi_1r_{t-2}+a_{t-1}\)</span> ，因此兩者沒有關係</li>
<li><span class="math inline">\(\phi_1^2 &lt; 1:\)</span> 因為隨機變數的變異數是非負且有界的</li>
</ul>
<p>且根據上述的公式我們可以推出</p>
<ul>
<li><strong>AR(1) 模型是弱穩態的充分必要條件是 <span class="math inline">\(|\phi_1| &lt; 1\)</span></strong></li>
</ul>
</section>
<section id="ar1-自相關係數" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="ar1-自相關係數"><span class="header-section-number">2.1.5</span> AR(1) 自相關係數</h3>
<p>自相關係數 <span class="math inline">\(\phi_\ell=\gamma_\ell/\gamma_0\)</span>，我們在先前的章節中已經計算過 <span class="math inline">\(\gamma_0\)</span> (變異數)，因此我們只要知道 <span class="math inline">\(\gamma_\ell=\mathbb{E}[(r_{t}-\mu)(r_{t-\ell}-\mu)]\)</span> 即可，這裡直接給出結論</p>
<p><span class="math display">\[
\gamma_{\ell} = \begin{cases}
\phi_{1}\gamma_{1} + \sigma_{a}^{2} &amp; \text{if } \ell = 0, \\
\phi_{1}\gamma_{\ell-1} &amp; \text{if } \ell &gt; 0.
\end{cases}
\]</span></p>
<p>因此我們有</p>
<ul>
<li><span class="math inline">\(\gamma_0=\mathrm{Var}(r_t)=\frac{\sigma^2_a}{1-\phi_1^2}\)</span></li>
<li><span class="math inline">\(\gamma_\ell=\phi_1\gamma_{\ell-1}\)</span> (<span class="math inline">\(\ell &gt; 0\)</span>)</li>
</ul>
<p>把上面的第二個公式慢慢迭代就有</p>
<p><span class="math display">\[
\rho_{\ell}=\phi_{1}\rho_{\ell-1}=\cdots=\phi_{1}^{\ell}\rho_{0},\quad\mathrm{for}\quad\ell\ge0
\]</span></p>
<p>因此我們得到一個結論</p>
<ul>
<li><strong>AR(1) 模型的 ACF 圖呈現指數遞減</strong></li>
</ul>
<p>相同的手法可以用在 AR(2) 或其他，但是這裡我們就不提供證明過程了</p>
</section>
<section id="ar-order-估計" class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="ar-order-估計"><span class="header-section-number">2.1.6</span> AR Order 估計</h3>
<p>那我們要用什麼方法估計資料到底是 AR 多少的模型呢? 如果是資深機器學習或資料科學家，他們應該會說使用交叉驗證來找到最好的 p，當然沒錯，但是我們必須注意到在時間序列的資料中是有順序性的，統計學家們較為常用的方法是使用 AIC、BIC 選模型，簡單來講，就是跑一個迴圈去檢查每一個 p，然後選出最好的 BIC 和 AIC，我們這裡簡介 AIC 和 BIC 的使用時機</p>
<ul>
<li>AIC: 收斂速度很快，可以有效保證收斂到真實值附近，但是較難趨近真值</li>
<li>BIC: 需要大樣本，在大樣本下，BIC 可以收斂到真值，但是速度較慢</li>
</ul>
<p>因此假設我們的資料是 AR(3) 模型，AIC 可能很快就可以收斂到 2~4 之間，但是比較難到達 3，但是 BIC 不一樣，你只要給足夠多的資料，他就會趨近 3</p>
<p>除了使用 AIC 和 BIC 之外，我們也可以使用 Partial Autocorrelation Function (PACF)，在介紹 PACF 之前，我們先想一個問題，假設我想要調查時間差為 K 期的相關性，我當然可以直接計算 lag-K 的自相關係數，但是，我要如何保證這 K 期的相關性並不是 K 個 1 期時間差的影響組合成的? PACF 就試圖解決這個問題</p>
<p><span class="math display">\[
\begin{array}{l}
{{r_{t}=\phi_{0,1}+\phi_{1,1}r_{t-1}+e_{1t},}}\\
{{r_{t}=\phi_{0,2}+\phi_{1,2}r_{t-1}+\phi_{2,2}r_{t-2}+e_{2t},}}\\
{{r_{t}=\phi_{0,3}+\phi_{1,3}r_{t-1}+\phi_{2,3}r_{t-2}+\phi_{3,3}r_{t-3}+e_{3t},}}\\
{{\vdots}}\quad \quad {{\vdots}}
\end{array}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(\phi_{i,j}\)</span> 表示第 <span class="math inline">\(\text{AR}(j)\)</span> 模型 <span class="math inline">\(r_{t-i}\)</span> 的影響係數</li>
<li><span class="math inline">\(e\)</span> 為誤差項</li>
<li><span class="math inline">\(\phi_0\)</span> 為常數項</li>
</ul>
<p>我們最感興趣的就是 <span class="math inline">\(\hat \phi_{j,j}\)</span> (lag-<span class="math inline">\(i\)</span> PACF)，<span class="math inline">\(\hat \phi_{2,2}\)</span> 表示添加 <span class="math inline">\(r_{t-2}\)</span> 後比起 AR(1) 模型增加的資訊量。有很多方法都可以求解 PACF，包含 OLS, Yule-Walker, Burg”s method, Levinson-Durbin 等等，以下提供 python 代碼</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># source https://www.jianshu.com/p/811f9ea0b52d</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.linalg <span class="im">import</span> toeplitz</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yule_walker(ts, order):</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Solve yule walker equation</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array(ts) <span class="op">-</span> np.mean(ts)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> x.shape[<span class="dv">0</span>]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> np.zeros(order<span class="op">+</span><span class="dv">1</span>, np.float64) <span class="co"># to store acf</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    r[<span class="dv">0</span>] <span class="op">=</span> x.dot(x) <span class="op">/</span> n <span class="co"># r(0)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, order<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        r[k] <span class="op">=</span> x[:<span class="op">-</span>k].dot(x[k:]) <span class="op">/</span> (n <span class="op">-</span> k) <span class="co"># r(k)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> toeplitz(r[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.linalg.solve(R, r[<span class="dv">1</span>:]) <span class="co"># solve `Rb = r` to get `b`</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pacf(ts, k):</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' </span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute partial autocorrelation coefficients for given time series，unbiased</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> [<span class="fl">1.</span>]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        res.append(yule_walker(ts, i)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>我們同樣使用隨機遊走的範例說明，可以看到除了 lag-1，其他相關性全部被壓到 0 附近</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rw_acf <span class="op">=</span> pacf(walks, k<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'PACF Random Walks (coef=0.3)'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>rw_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="174b684b-2f05-4e06-a3f4-ef4935e13e62" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("174b684b-2f05-4e06-a3f4-ef4935e13e62")) {                    Plotly.newPlot(                        "174b684b-2f05-4e06-a3f4-ef4935e13e62",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0,0.7401556228480181,-0.03189426626132651,0.04577636727578567,-0.0662579968280983,-0.0140565746842566,-0.004205589117461218,-0.005504968974528256,-0.040714238420663094,0.043834189996522284,0.017868210900516983,0.029302210594094123,-0.019463667827446587,-0.007075173605717175,-0.03755614791161308,-0.0008420447946856729,-0.015248157178999534,-0.009172842968112325,-0.019481586121579852,-0.012076292571465749,-0.008118719589273965,0.05231720960682781,0.0004825813424537546,0.031127523370549942,0.022172030212199677,0.019192969563200053,0.029379782406066826,-0.06085753681392977,0.03479368958261404,-0.05178704094987253,-0.009121179043468161,-0.016802096679627725,-0.023893036860895233,-0.04160680803875941,0.006156917275050942,-0.004895037744137235,0.027904172227812635,-0.014076544890824924,0.019582253694989945,0.018786343648083844,-0.015516672510260917,-0.014128351293063796,-0.02729663073910914,-0.05314459558365911,-0.05061289240449558,0.009865568803428202,0.02131462178589586,-0.01954335299663206,-0.04725343613669318,0.005939291198968728,0.02624393920429385,-0.0019134490750777873,0.018308001576684357,-0.03425293905412013,0.014391307404675152,0.06457081206991898,0.07588348108549149,-0.0636607116997626,0.025490121346781938,-0.023442584212837327,-0.017453846831120817,0.08314498449925906,0.02253039350947513,0.025018097745956695,0.0033528125585786804,-0.023695404373032497,-0.025887181670786307,-0.03297273838180693,0.0548532473885171,-0.009333575708977703,0.03581525743990328,0.016003496932871793,-0.007564724559959866,-0.018560629639699743,-0.03478065636346408,-0.05347894039834181,-0.03816264486071037,-0.02226068897273856,-0.014359014019335314,0.044766660358045905,0.0012065134567685876,0.04159575434924134,-0.03901681091421859,0.03453068672351138,0.0018624004179651275,-0.02822798808345594,0.07797241347784747,-0.06690775998056969,0.012945578162776592,-0.01523797947690375,-0.0032786445926337162],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"PACF Random Walks (coef=0.3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('174b684b-2f05-4e06-a3f4-ef4935e13e62');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>這裡我們就可以談談 PACF 的特性</p>
<ul>
<li><span class="math inline">\(\hat \phi_{j,j} \to \phi_p \quad \text{as} \quad T \to \infty\)</span></li>
<li><span class="math inline">\(\hat \phi_{\ell, \ell} \to 0 \quad \forall \ell &gt; j\)</span></li>
<li><span class="math inline">\(\hat \phi_{\ell, \ell}\)</span> 的漸進變異數是 <span class="math inline">\(1/T\)</span> 對所有 <span class="math inline">\(\ell &gt; j\)</span></li>
</ul>
<p>表示對於一個 AR(p) 序列，PACF 在 lag-p 會有明顯的截斷面</p>
</section>
<section id="ar-模型參數估計" class="level3" data-number="2.1.7">
<h3 data-number="2.1.7" class="anchored" data-anchor-id="ar-模型參數估計"><span class="header-section-number">2.1.7</span> AR 模型參數估計</h3>
<p>最後，我們來講講怎麼估計 AR(p) 模型，AR(p) 模型可以看成是一個多元線性回歸，只是變數都是過去時間，因此我們有</p>
<p><span class="math display">\[
r_{t}=\phi_{0}+\phi_{1}r_{t-1}+\dots+\phi_{p}r_{t-p}+a_{t},\quad t=p+1,\dots,\,T
\]</span></p>
<p>當我們把這 <span class="math inline">\(T-p\)</span> 條公式寫開之後，就可以使用 OLS 或者梯度下降方式去估算參數</p>
<p><span class="math display">\[
\hat{r}_{t}=\hat{\phi}_{0}+\hat{\phi}_{1}r_{t-1}+\cdot\cdot\cdot+\hat{\phi}_{p}r_{t-p}
\]</span></p>
<p>有了估計式之後，我們就可以計算誤差 (殘差項) <span class="math inline">\({\hat{a}}_{t}=r_{t}-{\hat{r}}_{t}\)</span></p>
<p>Note: 如果序列資料來自於 AR(p) 模型，那麼該模型的參數應該呈現出白噪聲的樣子</p>
</section>
<section id="ar-模型的預測" class="level3" data-number="2.1.8">
<h3 data-number="2.1.8" class="anchored" data-anchor-id="ar-模型的預測"><span class="header-section-number">2.1.8</span> AR 模型的預測</h3>
<p>當我們建立一個模型之後，當然是想用他去預測未來的資料，這個概念在時間序列中稱為 forecasting，如果寫的數學一點就像</p>
<p><span class="math display">\[
E\{[r_{h+\ell}-\hat{r}_{h}(\ell)]^{2}|F_{h}\}\leq\operatorname*{min}_{g}E[(r_{h+\ell}-g)^{2}|F_{h}]
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(F_h\)</span> 表示在 <span class="math inline">\(h\)</span> 時間點之前我們所擁有的所有資訊</li>
</ul>
<p>簡單來說，就是站在時間點 <span class="math inline">\(h\)</span>，當我們想要估計 <span class="math inline">\(l\)</span> 期時間後的值，我們會找一個 MSE 最小的 <span class="math inline">\(g\)</span> 最為我們的預測值</p>
<p>舉例來說，我們想要用一個 AR(p) 模型估計 <span class="math inline">\(l\)</span> 天後的股價，我們當然可以寫</p>
<p><span class="math display">\[
r_{h+\ell}=\phi_{0}+\phi_{1}r_{h+\ell-1}+\cdot\cdot\cdot+\phi_{p}r_{h+\ell-p}+a_{h+\ell}
\]</span></p>
<p>但是要注意到，我們事實上完全沒有 <span class="math inline">\(1,2,\cdots,l-1\)</span> 天的股價資訊，而這些資訊又是 AR(p) 模型必要的特徵，因此，我們只能使用類似於滑動窗口的方式，先估計一天後，兩天後，最後才到 <span class="math inline">\(l\)</span> 天後，這過程，我們必須不斷使用我們的估計值去取代真實值，因此距離現在的時間越遠，我們的估計就越不準</p>
</section>
<section id="ar-練習" class="level3" data-number="2.1.9">
<h3 data-number="2.1.9" class="anchored" data-anchor-id="ar-練習"><span class="header-section-number">2.1.9</span> AR 練習</h3>
<ol type="1">
<li>首先我們先來生成一組 AR(3) 的 資料</li>
</ol>
<p><span class="math display">\[
r_t=0.01+0.1*r_{t-1}-0.1*r_{t-3}+a_t
\]</span></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_ar_data(n, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate AR data with the specified equation.</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">        n (int): Number of data points to generate.</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">        mu (float): Mean of the random noise.</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">        sigma (float): Standard deviation of the random noise.</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">        np.array: Array of AR data points.</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize arrays</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    ar_data <span class="op">=</span> np.zeros(n)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    epsilon <span class="op">=</span> np.random.normal(mu, sigma, n)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate AR data</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, n):</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        ar_data[t] <span class="op">=</span> <span class="fl">0.01</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> ar_data[t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> ar_data[t<span class="op">-</span><span class="dv">3</span>] <span class="op">+</span> epsilon[t]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ar_data</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> generate_ar_data(<span class="dv">500</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">"Simulated AR(3) data"</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="a633191e-e2da-4026-9950-8981e244b403" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a633191e-e2da-4026-9950-8981e244b403")) {                    Plotly.newPlot(                        "a633191e-e2da-4026-9950-8981e244b403",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"lines","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.0,0.0,0.0,1.5330298564080254,-0.07085038908253341,-0.2312219958574339,1.4127876302808455,0.9257985310892467,-0.34377233324028406,0.3769040472338517,-0.5083071411980018,-0.47218323436602866,0.16705354340604608,-1.8357441761973932,-1.8512739266961693,-0.7541202762511943,-0.8946687303398039,0.41990785223091043,-0.7806212626730005,-1.3908989545686112,1.294568088241602,-0.008257365395075406,0.21579236360527743,-1.5226257586770893,-0.685819563853384,0.030761396963999932,-0.9856548618581938,0.35571448854519094,-0.5581433807606859,-0.238942601683526,-0.6511723212522686,1.8529752904597796,0.20569456447639667,-0.9620242403830338,0.5510449590189077,-1.176308610516771,0.19743515799138167,-1.9850311039825281,-1.3990582982450062,0.04721189024548475,0.9516908794182117,0.4164431989562923,-0.06872515151715977,-0.39314529868282594,-1.5494808401313391,-0.8579197772561266,-0.49711621881711754,1.1723586883503379,0.5566461361291078,-1.6476639198681113,0.05208170857295008,-0.4255387231719323,-0.5447094806363408,0.5619971699199388,1.139753111805138,1.1097263783603464,-0.7744446023785978,-0.49063214726958815,0.1812275788405705,1.081112345244276,-0.31199978859390354,-0.22498171340726453,-1.2269443798711823,-1.2777010832083986,0.7172538854140846,1.5606598550993496,0.221825972250441,0.9639901065756598,0.31196905019526516,-0.6261054468106418,0.21238605016978376,1.5380782664634212,0.1905923322174548,1.5724642840187733,-2.6063065023342094,0.5522126209200574,-0.004978098071700368,-0.028874510039616552,0.0436520634395349,-1.9727058984497692,-0.4040550266785272,0.3223418624999402,1.717398820836487,-0.2961248335221459,-0.8603402724953962,-0.7495309529177249,0.8800615057625162,0.5127912874854756,-0.3935279797267187,0.3959084845644326,0.09538926905593609,1.0275367154111548,-0.6288902707926802,-0.39009010058262983,-0.5238708347315361,-1.4430130045260041,0.20082798667023863,0.3435251543200668,0.193767272527068,-0.225293204789464,-1.4622525779613673,-0.5762473078142025,-0.36780992682924335,-0.6828330041084065,-0.16194428129542954,0.4346374213679198,2.007932943758163,0.4015655353371982,0.2642432021196922,-0.2388148899300143,-1.9728092578257628,-0.24021912144376237,0.07008978678965162,2.6775320169468277,0.10941414905793656,0.31547977856044096,-0.26091699354388204,-1.1957111518797139,1.0017037214710052,0.8881951041882629,1.0094225726498447,-0.898615569676855,1.2341132435495874,-1.3693819957023066,0.5497804511977251,2.1320223465747925,-0.6303958909029784,-0.6743153638128423,-0.17098240595112224,-0.4475343056210136,-1.5179853252469497,-0.056137317123555436,-1.013164014876359,0.5340745616722407,-0.8504030463542236,1.576210501869753,-0.6690396983164858,-0.29392518140190177,0.6365036490425042,-1.0903099816980562,0.15782145457451396,1.2692745348356291,-1.361524782907859,0.042699234784066925,0.14722526424326732,0.942697876492423,-1.1369508467072464,-1.4388742241793278,0.29378435554972254,0.450058193458883,0.4493860921096976,0.3720083831529732,-0.6778297026090818,0.12953211768912562,0.27882484675229646,-0.6086859630902299,1.801952703066821,0.63614570654324,-1.0568203302393016,0.38067630530321744,-0.9902286103513237,0.8037437757312498,1.2109023260502072,-0.5905692247115574,0.8339448292000411,0.3850851772514817,0.9296256001907939,1.9163610597530227,-0.08226052775271639,-0.8449247771518407,-1.1556430133160096,-0.9131485335217676,-0.07392408505109689,0.45932386764313515,0.4239380394465093,0.8869694614857844,0.06576645126217193,1.4277169183388831,-0.20058208755264617,2.703534312708137,0.7632490872019316,-0.7507744389408247,-1.4063233732260085,0.27551516920039126,-0.1108338245117293,0.8535494489635199,0.5410410525498577,0.002358575049285924,-0.9219128054598283,-1.6511426104868332,-0.601865070620633,0.8984035678073918,0.4790483619596265,-1.127647435453962,-0.019424174474953426,0.3454701260853788,-0.7265456800471989,0.09301295538830334,0.042963001376292345,-1.056019429688274,0.2528841218406256,0.5917766384146678,1.2578308499855713,1.1642967248493976,-1.3104173593136181,-1.1846498608450418,0.2901406086392158,0.6838417477074922,0.7118968471613013,3.90490711450693,0.9029970473731108,1.1646756602017798,0.6899786180626872,0.6400894083747557,-0.35772786982304805,0.6641985717046939,-0.760414298204578,-0.2670872495781619,-0.5684921299573891,0.11106635621104145,2.362473927252429,-1.5641685868707662,0.5287366960663327,-1.7860895943082613,-0.48412396653318296,0.9976645307074146,0.3526554315970304,-0.9840668381162848,-0.9034768461423381,0.5639845211607389,-0.5655614957894343,0.26025012461726527,0.025198400249466416,-0.582524358001927,2.0696666410634066,0.8483658463994053,-1.872053566217474,-0.19771770595866045,-0.7563948200041946,0.9739992094175519,-0.6653490468950793,-0.09563186415598748,0.4080241716231032,0.9830925160219397,-1.0824239690379835,-0.47354604990705707,-0.6106091677538559,-0.5961477524452992,1.7631940700272726,0.6523620347390684,-1.1260329756166083,0.6389392424903879,2.130813917787765,1.3681499498915843,-1.4364488952138939,-0.8309603541664172,1.0570001187808225,-0.4483245642193091,0.4920830071409393,0.7281423422653485,-0.7992837809296172,-0.17866203486885573,-3.321947777782493,-1.2666540410195775,-0.3513673520082325,-0.9407251393874234,1.6750041940948506,-1.2175042233503244,-0.45772239509327384,-0.07253208163272112,1.565770503237876,-1.2235128613463244,1.0580656741835992,-0.03053742188584064,-0.8522111071019025,0.28107579613472056,0.24022101737552615,-0.4809736647110518,0.003597138905441666,-0.39897598470876866,0.13171711325147636,0.6849426719556502,1.704408681811794,-1.0705463419708172,1.9674844732636199,-1.9157802203773193,-0.22630848287623354,0.3789379108705912,0.5204636808598238,-0.5380223034469881,-0.28981827178903313,-0.5640291299237186,-0.5819654395918846,0.8303873802407394,0.5064571369814932,-0.5740673376033164,0.7691544036488451,0.3435692475433445,0.9146257773536262,0.6541759792940903,-0.7879343377469977,-0.720437051707032,0.6198323020231495,0.7611469294104796,0.137256804147603,0.07906983352122735,1.2194571861994996,-0.47335135063064027,0.5018552627548512,-0.2639528447783589,-0.18674135264199215,1.0399171904475057,0.9658033525106163,0.9387641065158994,1.3053634987611684,0.06495985625781427,0.6045725462691554,-0.37034585184265734,0.29063578167839493,-0.1515367308267606,0.12887687709430787,0.5889811349785049,-0.7341688966529459,2.016082698310735,-0.8533072251664789,-1.2161024456390854,0.8448923591050858,0.9714826523900923,0.8528783268550729,0.6391441060392786,-0.035480627481996,-0.9760902669195384,-0.07571887910215538,-0.6711855366741276,1.0156102064422923,-0.027924472947693887,-0.7511710904198682,-0.4880639713392095,0.37691750443647276,-0.4409156933183406,-0.8075055677643446,0.13524490427183056,0.31258263086773985,-0.3849343555079213,-0.513056231596298,0.1594860511112325,-1.3836423008354086,-1.4845223813004662,-0.8728450644936059,-0.15236742807766696,0.45412306092028454,1.618053029490941,1.0447016689588802,-0.09088066915956755,-0.1799095777677397,-1.1149904893104707,-0.11092411800748025,-0.2717600929441124,0.41704159997472534,-0.7644343717541024,0.48007908636017327,1.5490426616411226,0.13258755488266494,0.3769625689511906,0.5829359824421193,-0.3461856291298908,0.16177766200230861,-0.019523431262186204,0.14034231833560218,-0.7651533182221372,-0.0400528144370524,0.4899587779681843,1.5866548174140738,1.1319415892703195,2.2273807386417697,-0.6932749707652799,0.6997989807171182,0.04058382994588658,2.273188813288789,-0.6409593020979845,-0.8978761553851632,-0.9064991423114174,-2.14044970833115,-0.6400123769753597,-0.7224839850200921,0.30219035880731343,0.4459762493554268,2.003016862653438,1.1305064885706628,-0.4984506317408795,-1.1385614207877897,0.27501238057066046,-1.2328869057894882,1.832026217354184,1.3451415043996393,-0.20137281108579203,-1.9064744319348752,1.0387107805319613,0.01946851390915745,1.440410606557865,-1.5442576761917768,-0.7457476419638663,-0.20337212513398997,0.19106914887052076,-0.34638379239580497,0.6185487656213172,-1.0148724677075147,-0.1992283525524645,0.048517919894520686,0.6307778728189526,0.8046155006260315,-1.0390323337647183,-1.6910951913939893,1.038105752696507,0.5500278206257142,-0.5143742353545833,1.405903976717414,0.21126224990202863,1.2618608325894876,0.06311416699731633,2.055933116591516,1.8447480708434072,-0.06080075809446439,0.7698975634857573,0.5478908988493826,1.4395007232267334,-0.8879631446060069,0.5524660556529004,0.9797210200922045,-1.5619710699532932,-1.3847022252263945,-2.2656745022919607,-0.3297771776784245,0.8330347605507593,1.8222279783803002,0.29929529602564764,1.5852415991187807,-1.3938000961410433,-1.8626919785718237,-0.3903410566656792,0.4944113528868437,0.21301558505177365,-1.9971064358681314,-0.3282718183882859,-1.3485982408488593,0.7445233683319656,0.48387776476887345,-0.746632185765582,-0.6529824727464484,-1.1628995456404838,-0.09430583326066207,1.0210099844498168,-0.7573350933265137,0.44774358951125925,-0.5775842578662965,-0.7648977487163224,-0.21829449377731602,-0.989313346010476,-0.5660908650765974,-1.2226575297187767,1.9513907145455591,0.29701170993394427,-0.5377585840273135,-0.024935019123065255,-0.13452272259653078,-0.1706460133901447,0.6095956006167172,0.8419195423686299,-0.41924459203465003,-0.6687022599098167,-0.4161138773794887,-2.2916080932700686,-1.6674816455345773,1.2517374906290157,2.009302271891192,0.12864235218619868,0.4742474492114847,0.16774467227556533,3.0927910404641743,1.3914292705598457,0.004450868347661507,-1.254374457812077,-1.8610266930947648,0.026915879722980457,-0.6182217115307975,-1.2879732114412774,-0.7680617933589524,-1.0865320117972104,1.7172857550369716,1.140174511789043,0.22469801104200796,1.3406853644905294,0.10741939291776696,-0.8630120631406878,1.3127543345065356,0.6694435378435355,-0.874000594228034,-0.39901417095706515,-0.9724640242648173,-1.3826460739680144],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Simulated AR(3) data"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a633191e-e2da-4026-9950-8981e244b403');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<ol start="2" type="1">
<li>畫出 ACF plot</li>
</ol>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_acf <span class="op">=</span> acf(data, lag<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF AR(3)'</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="9c062f97-b254-4c72-8fe6-67b8ceef827c" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9c062f97-b254-4c72-8fe6-67b8ceef827c")) {                    Plotly.newPlot(                        "9c062f97-b254-4c72-8fe6-67b8ceef827c",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[0.9999999999999993,0.10098267174069911,-0.012299733338092778,-0.09880923366774293,-0.08879849749029085,0.035505017245174415,0.04429459347316738,-0.017265438027354158,-0.09152536028045706,-0.036011127101140586],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF AR(3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9c062f97-b254-4c72-8fe6-67b8ceef827c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>可以看到在 lag-3 的相關係數最大</p>
<ol start="3" type="1">
<li>畫出 PCAF plot</li>
</ol>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_pacf <span class="op">=</span> pacf(data, k<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'PACF AR(3)'</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data_pacf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="e4135595-2c22-4ccc-a941-070d9aa3ef3e" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4135595-2c22-4ccc-a941-070d9aa3ef3e")) {                    Plotly.newPlot(                        "e4135595-2c22-4ccc-a941-070d9aa3ef3e",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0,0.10118504182434788,-0.02282119536269739,-0.09686006289507323,-0.07123077453400803,0.05030825627863442,0.0263481814277006,-0.0400715889975431,-0.0884247028487257,-0.0062145244343211605,-0.007853366434763427],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"PACF AR(3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e4135595-2c22-4ccc-a941-070d9aa3ef3e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>同 ACF，可以看到在 lag-3 的相關係數最大</p>
<ol start="4" type="1">
<li>用 AIC 估計 AR order</li>
</ol>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.ar_model <span class="im">import</span> AutoReg</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>best <span class="op">=</span> <span class="bu">float</span>(<span class="st">"inf"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>best_order <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> order <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    ar_model <span class="op">=</span> AutoReg(data, lags<span class="op">=</span>order).fit()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"AR(</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">) AIC: "</span>, ar_model.aic)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ar_model.aic <span class="op">&lt;</span> best:</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        best <span class="op">=</span> ar_model.aic</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        best_order <span class="op">=</span> order</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Selected best order: "</span>, best_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AR(1) AIC:  1407.3539983067183
AR(2) AIC:  1407.2913499349963
AR(3) AIC:  1402.828223161296
AR(4) AIC:  1398.1094017600367
AR(5) AIC:  1397.0403557874909
AR(6) AIC:  1396.8567941625547
AR(7) AIC:  1393.7280505207527
AR(8) AIC:  1389.2987596911696
AR(9) AIC:  1389.2034251860591
Selected best order:  9</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>用最好 AIC 選出來的 order 重新 fit 一次 data</li>
</ol>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ar_model <span class="op">=</span> AutoReg(data, lags<span class="op">=</span>best_order).fit()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ar_model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            AutoReg Model Results                             
==============================================================================
Dep. Variable:                      y   No. Observations:                  500
Model:                     AutoReg(9)   Log Likelihood                -683.602
Method:               Conditional MLE   S.D. of innovations              0.974
Date:                Mon, 04 Mar 2024   AIC                           1389.203
Time:                        13:05:55   BIC                           1435.364
Sample:                             9   HQIC                          1407.331
                                  500                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.0117      0.044      0.267      0.790      -0.075       0.098
y.L1           0.0928      0.045      2.053      0.040       0.004       0.181
y.L2           0.0003      0.045      0.007      0.994      -0.088       0.089
y.L3          -0.0903      0.045     -2.003      0.045      -0.179      -0.002
y.L4          -0.0882      0.045     -1.947      0.052      -0.177       0.001
y.L5           0.0406      0.045      0.894      0.372      -0.048       0.130
y.L6           0.0287      0.045      0.635      0.526      -0.060       0.117
y.L7          -0.0319      0.045     -0.708      0.479      -0.120       0.057
y.L8          -0.0871      0.045     -1.929      0.054      -0.176       0.001
y.L9          -0.0058      0.045     -0.127      0.899      -0.094       0.083
                                    Roots                                    
=============================================================================
                  Real          Imaginary           Modulus         Frequency
-----------------------------------------------------------------------------
AR.1            1.2163           -0.5437j            1.3323           -0.0669
AR.2            1.2163           +0.5437j            1.3323            0.0669
AR.3            0.5383           -1.1338j            1.2551           -0.1794
AR.4            0.5383           +1.1338j            1.2551            0.1794
AR.5           -1.3244           -0.5728j            1.4430           -0.4350
AR.6           -1.3244           +0.5728j            1.4430            0.4350
AR.7           -0.6288           -1.2763j            1.4228           -0.3229
AR.8           -0.6288           +1.2763j            1.4228            0.3229
AR.9          -14.7478           -0.0000j           14.7478           -0.5000
-----------------------------------------------------------------------------</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>檢查殘差是否為白噪聲</li>
</ol>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_acf <span class="op">=</span> acf(ar_model.resid, lag<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'ACF AR(3)'</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(T)), y<span class="op">=</span>data_acf, mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"sin"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    connectgaps<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span>title)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="5427a0c8-a76f-4f0d-a1ea-f122a03fb28f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5427a0c8-a76f-4f0d-a1ea-f122a03fb28f")) {                    Plotly.newPlot(                        "5427a0c8-a76f-4f0d-a1ea-f122a03fb28f",                        [{"connectgaps":true,"line":{"color":"blue","width":1},"mode":"markers","name":"sin","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999],"y":[1.0,0.000484031755930371,-0.0016806191919387517,0.0018405175938266151,0.004469594584413491,-0.0026635930968989816,-0.00040271834177121597,0.01529885021695281,0.013750273444059642,0.002138303174270592],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"ACF AR(3)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5427a0c8-a76f-4f0d-a1ea-f122a03fb28f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>可以發現在 fit 完 AR 模型之後，殘差的 ACF 圖中相關性已然趨近於 0 點附近，表示殘差之間並沒有相關性</p>
</section>
</section>
<section id="moving-average-ma-模型" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="moving-average-ma-模型"><span class="header-section-number">2.2</span> Moving Average (MA) 模型</h2>
<p>我們前面談到 AR 模型都是有限 order 的，也就是 p 是有限的，但是當我會感興趣，當 order 無限時會發生什麼，也就是</p>
<p><span class="math display">\[
r_t=\phi_0 + a_t + \sum_{i=1}^\infty\phi_ir_{t-i}
\]</span></p>
<p>雖然我們可以往回頭看無限遠的過去，但是這是不切實際的，因為同時也有無限多個參數需要估計，因此，我們勢必要對參數做一些假設，例如 <span class="math inline">\(\phi_i=-\theta_1^{i}\)</span>，因此我們有</p>
<p><span class="math display">\[
r_t=\phi_0 + a_t + \sum_{i=1}^\infty-\theta_1^{i}r_{t-i}
\]</span></p>
<p>在上面的公式中，要求 <span class="math inline">\(|\theta_i| &lt; 1\)</span>，才能夠保證距離當前越遠的時間影響越小，而加上負號只是為了計算方便，有趣的地方來了，當我們根據上面的公式計算 <span class="math inline">\(r_t-\theta_1r_{t-1}\)</span> 時我們有</p>
<p><span class="math display">\[
r_t=\phi_0(1-\theta_1)+a_t-\theta_1a_{t-1}
\]</span></p>
<p>可以看到 MA(1) 模型是將當前 shock <span class="math inline">\(a_t\)</span> 和前一期 shock 做加權平均。有了這個公式之後，我們就可以開始介紹更為廣義的 MA 模型</p>
<p><span class="math display">\[
r_t = c_0 + a_t + \sum_{i=1}^q \theta_ia_{t-i}
\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(c_0\)</span> 常數，用來代表平均</li>
<li><span class="math inline">\(a_i\)</span> 為過去 shock (誤差)</li>
</ul>
<p>MA 模型假設時間序列資料的波動變異都來自於 shocks，因此 MA 模型利用當前與過往的 shocks 做加權平均，也可以想 <strong><span class="math inline">\(r_t\)</span> 是當前 shocks 加上過往的預測誤差的加權平均</strong>。</p>
<p>Note:</p>
<p>雖然上述公式看起來像是回歸模型，但是 <span class="math inline">\(a_t\)</span> 是無法觀測到的</p>
<section id="maq-平均數" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="maq-平均數"><span class="header-section-number">2.2.1</span> MA(q) 平均數</h3>
<p>因為 shocks 是平均值為 0 的白噪聲序列，因此 MA(q) 的平均數非常簡單可以寫成</p>
<p><span class="math display">\[
\mathbb{E}(r_t) = c_0
\]</span></p>
<p>這個公式自帶滿足弱穩態的平均值與時間無關條件，接下來我們檢查變異數</p>
</section>
<section id="maq-變異數" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="maq-變異數"><span class="header-section-number">2.2.2</span> MA(q) 變異數</h3>
<p>同樣地，因為 <span class="math inline">\(a_i\)</span> 與 <span class="math inline">\(a_j\)</span> 沒有相關性 <span class="math inline">\((i\neq j)\)</span>，我們也可以計算變異數如下</p>
<p><span class="math display">\[
\mathrm{Var}(r_{t})=(1+\theta_{1}^{2}+\theta_{2}^{2}+\cdots+\theta_{q}^{2})\sigma_{a}^{2}
\]</span></p>
<p>從上面看出，MA 也滿足變異數與時間無關之條件，因此，<strong>MA 序列是保證弱穩態的</strong></p>
</section>
<section id="maq-自相關係數" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="maq-自相關係數"><span class="header-section-number">2.2.3</span> MA(q) 自相關係數</h3>
<p>這裡我們從 MA(1) ACF 出發，來討論 MA(q) 的自相關係數應該長什麼樣子，以下我們假設 <span class="math inline">\(c_0=0\)</span></p>
<p><span class="math display">\[
r_{t-\ell}r_{t}\,=\,r_{t-\ell}a_{t}\,+\,\theta_{1}r_{t-\ell}a_{t-1}
\]</span></p>
<p>對上式取期望值以及代入 <span class="math inline">\(\mathrm{Var}(r_{t})=(1+\theta_{1}^{2})\sigma_{a}^{2}\)</span> 之後，我們有</p>
<p><span class="math display">\[
\rho_{0}=1,\quad\rho_{1}=\frac{\theta_{1}}{1+\theta_{1}^{2}},\quad\rho_{\ell}=0,\quad\mathrm{for}\quad\ell&gt; 1
\]</span></p>
<p>從上面的自相關係數可以發現，在時間差大於一期之後相關係數全為 0，表示 MA(1) 會在 Lag-1 之後突然全部降為 0，由此，我們可以推測 MA(q) 模型 ACF 的特性為 <span class="math inline">\(\rho_ell=0\)</span> 只要 <span class="math inline">\(\ell&gt;q\)</span>，因此，當我們看到 ACF 圖中在 lag-q 之後有明顯的截斷，就可以推斷有可能是 MA(q) 模型</p>
<p>Note:</p>
<p>因為 MA(q) 公式表明時間差 &gt; q 期完全無關，因此 MA 是一個有限記憶的模型</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ts_intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">什麼是時間序列</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>